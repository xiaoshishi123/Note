# InventoräºŒæ¬¡å¼€å‘



### æ­¥éª¤ 0ï¼šä» Inventor å¯¼å‡ºç»“æ„åŒ–å‡ ä½•ï¼ˆç”±ä½ å†™ API å±‚ï¼Œè§„åˆ™å¯æ§ï¼‰

- å¯¹æ¯ä¸ª **Face** å¯¼å‡ºï¼š
   `id, surface_type, area, bbox, normal/axis, radius/angle, loop_count, adjacent_face_ids`
- å¯¹æ¯ä¸ª **Edge** å¯¼å‡ºï¼š
   `id, curve_type, length, radius(if arc), adjacent_face_ids`
- è¯†åˆ«ä¸€æ‰¹**å€™é€‰å·¥ç¨‹è¯­ä¹‰**ï¼ˆé ç¡®å®šæ€§è§„åˆ™ï¼‰ï¼š
  - `candidates.holes`: ç”±â€œå†…åœ†æŸ±é¢ + ä¸¤ç«¯å¹³é¢/å†…éƒ¨å°é—­â€åˆ¤å®š
  - `candidates.axes`: ç”±â€œå…±è½´åœ†æŸ±/åœ†é”¥/å­”â€èšç±»å¾—åˆ°
  - `candidates.datums`: é€‰â€œå¤§é¢ç§¯ã€å¹³æ•´ã€æ¥è¿‘å…¨å±€åŸºå‡†â€çš„å¹³é¢
  - `candidates.threads`: ä¼˜å…ˆè¯» `ThreadFeature`ï¼›æ²¡æœ‰åˆ™ä¾æ®å­”+ç›´å¾„åŒºé—´+å‘½å/æ³¨é‡ŠçŒœæµ‹ï¼ˆå¯é€‰ï¼‰

> è¿™ä¸€æ®µå®Œå…¨**ä¸éœ€è¦è®­ç»ƒ**ï¼Œæ˜¯ç¡®å®šæ€§å‡ ä½•è§„åˆ™ï¼›åšä¸åˆ°æ—¶ï¼Œå®å¯è¾“å‡ºâ€œæœªçŸ¥/å¾…äººå·¥ç¡®è®¤â€ã€‚

### æ­¥éª¤ 1ï¼šæŠŠ**å‡ ä½•æ‘˜è¦ + ä¸šåŠ¡ç›®æ ‡**å–‚ç»™å¤§æ¨¡å‹ï¼ˆLLM å……å½“â€œè§„åˆ’å™¨â€ï¼‰

- æä¾›å†…å®¹ï¼š
  - **é›¶å™ªå£° JSON**ï¼ˆè§ä¸‹ï¼‰+ ç®€å›¾åº¦é‡ï¼ˆå¦‚ 2D è§†å›¾æŠ•å½±çš„ bounding boxã€å·²å ç”¨åŒºåŸŸï¼‰
  - ä½ çš„**ç»˜åˆ¶çº¦æŸ**ï¼šå¦‚ â€œæ ‡æ³¨å°½é‡ä¸é‡å ã€ä¼˜å…ˆæ ‡ä¸»å°ºå¯¸ã€æ¯æ®µè½´é€‰ 1~2 ä¸ªå…³é”®å°ºå¯¸â€¦â€
  - **è¾“å‡º schema**ï¼ˆä½ å¸Œæœ› LLM å›ä»€ä¹ˆï¼‰ï¼šè¦æ ‡å“ªäº›ã€æ ‡æ³¨æ–‡æœ¬ã€æ”¾ç½®åæ ‡ã€å¼•çº¿è¿åˆ°å“ªä¸ªå®ä½“/ç‚¹
- **é›¶æ ·æœ¬/å°‘æ ·æœ¬æç¤º**ï¼šç»™ 1~2 ä¸ªæç®€ç¤ºä¾‹å³å¯ï¼Œä¸ç”¨è®­ç»ƒã€‚

### æ­¥éª¤ 2ï¼šæœ¬åœ°â€œåå¤„ç†ä¿®æ­£å™¨â€ï¼ˆç¡®å®šæ€§ï¼‰

- LLM ç»™çš„åæ ‡å¯èƒ½æœ‰å†²çª/é®æŒ¡ï¼Œä½ ç”¨**ç®€å•ç®—æ³•**å…œåº•ï¼š
  - ç¢°æ’æ£€æµ‹ + è¿­ä»£å¹³ç§»
  - åŠ›å¯¼å‘/ç½‘æ ¼å¸é™„
  - è§†çª—è¾¹ç¼˜å¯¹é½ï¼ˆç•™ç™½ï¼‰

### æ­¥éª¤ 3ï¼šè°ƒç”¨ Inventor API ç”»æ ‡æ³¨

- Drawing/Sketch ä¸‹æ”¾ç½®**å°ºå¯¸ã€å¼•å‡ºçº¿ã€æ³¨é‡Š**ï¼Œæˆ–ç›´æ¥åœ¨ 3D PMI é‡Œæ ‡æ³¨ï¼ˆè‹¥ä½ èµ° 3D æ³¨é‡Šæµï¼‰ã€‚
- å…¨ç¨‹**æ— è®­ç»ƒ**ï¼ŒLLM åªåšâ€œæŒ‘é€‰ä¸æ’å¸ƒå»ºè®®â€ã€‚

------

3) ä½ å¯ä»¥å¯¼å‡ºçš„ JSONï¼ˆç¤ºæ„ï¼‰

```
{
  "meta": { "model": "partA.ipt", "units": "mm" },
  "faces": [
    {"id": "F12", "surface_type": "Cylindrical", "radius": 10.0, "axis": [0,0,1], "area": 628.3, "bbox": [[-10,-10,0],[10,10,50]], "adjacent": ["F21","F22"]},
    {"id": "F21", "surface_type": "Planar", "normal": [0,0,1], "area": 314.1, "bbox": [[-10,-10,0],[10,10,0]]}
  ],
  "edges": [
    {"id": "E7", "curve_type": "Circle", "radius": 10.0, "adjacent_faces": ["F12","F21"]}
  ],
  "candidates": {
    "holes": [
      {"id":"H1", "cyl_face":"F12", "end_faces":["F21","F22"], "type":"through", "diameter":20.0, "axis":[0,0,1], "depth":50.0}
    ],
    "datums": [
      {"id":"D1", "face":"F21", "score":0.92, "normal":[0,0,1]}
    ],
    "axes": [
      {"id":"A1", "axis":[0,0,1], "via_faces":["F12"]}
    ],
    "threads": []
  },
  "view": {
    "projection": "front",
    "viewport": {"xmin": -80, "xmax": 80, "ymin": -60, "ymax": 60},
    "occupied_boxes": []
  }
}
```

------

### 4) ç»™ LLM çš„**æç¤ºæ¨¡æ¿**ï¼ˆé›¶è®­ç»ƒï¼‰

**ç³»ç»ŸæŒ‡ä»¤ï¼ˆç¼©å†™ç¤ºä¾‹ï¼‰**

> ä½ æ˜¯æœºæ¢°åˆ¶å›¾æ ‡æ³¨åŠ©ç†ã€‚æ ¹æ®è¾“å…¥çš„å‡ ä½•å€™é€‰ä¸è§†å›¾è¾¹ç•Œï¼Œäº§å‡ºå·¥ç¨‹ä¸Šåˆç†çš„æ ‡æ³¨æ–¹æ¡ˆã€‚ä¼˜å…ˆï¼šä¸»å°ºå¯¸â†’åŠŸèƒ½å°ºå¯¸â†’è£…é…ç›¸å…³ã€‚é¿å…é‡å ï¼›è‹¥ä¸ç¡®å®šè¯·æ ‡æ³¨â€œéœ€ç¡®è®¤â€ã€‚

**ç”¨æˆ·å†…å®¹**

- é™„ä¸Šä¸Šé¢çš„ JSON
- è§„åˆ™è¦ç‚¹ï¼ˆç¤ºä¾‹ï¼‰ï¼š
  1. è´¯ç©¿å­”ï¼šæ ‡ç›´å¾„ç¬¦å·â€œâŒ€â€ã€å­”ä¸­å¿ƒå¼•çº¿ã€å°½é‡æ”¾åœ¨è§†å›¾å¤–ä¾§è¿‘å¤„ï¼›
  2. è½´æ®µï¼šå¯¹æ¯æ®µæ ‡â€œâŒ€+é•¿åº¦â€ï¼›
  3. åŸºå‡†é¢ï¼šé€‰åˆ†å¸ƒç¨³å®šçš„å¤§é¢ï¼Œæ ‡æ³¨å½¢ä½å…¬å·®çš„åŸºå‡†å­—æ¯ï¼ˆè‹¥æœ‰éœ€æ±‚ï¼‰ï¼›
  4. å­—å·ä¸é‡è¦ï¼Œæœ¬æ¬¡åªç»™åæ ‡ä¸æ–‡æœ¬ï¼›
  5. åæ ‡å•ä½ä¸ `view.viewport` ä¸€è‡´ï¼›
  6. è¾“å‡º JSONï¼Œç»“æ„å¦‚ä¸‹ï¼š

```
{
  "annotations": [
    {
      "type": "diameter",
      "target": "H1",
      "text": "âŒ€20",
      "leader_to": {"entity": "H1", "attach": "rim"},
      "at": {"x": 50, "y": 10}
    }
  ],
  "notes": ["å°é˜¶å­”æœªè¯†åˆ«ï¼Œéœ€æ£€æŸ¥ F34 é™„è¿‘çš„ç¯å½¢é¢"]
}
```

------

### 5) å…³é”®/éš¾ç‚¹æ€ä¹ˆ**ä¸ç”¨è®­ç»ƒ**ä¹Ÿèƒ½åšï¼Ÿ

- **å­”/è½´/åŸºå‡†è¯†åˆ«**ï¼šé  B-Rep è§„åˆ™è¶³å¤Ÿç¨³ï¼ˆåœ†æŸ±é¢+ç«¯é¢ã€å…±è½´èšç±»ã€é¢ç§¯ä¸æ³•å‘é˜ˆå€¼ï¼‰ã€‚
- **èºçº¹**ï¼šä¼˜å…ˆä» FeatureTree è¯» `ThreadFeature`ï¼›è¯»ä¸åˆ°å°±è¾“å‡ºâ€œæœªçŸ¥/éœ€ç¡®è®¤â€ï¼Œä¸è¦ç¡¬çŒœã€‚
- **æ ‡æ³¨æ”¾ç½®**ï¼šLLM ç»™â€œåˆç¨¿å¸ƒå±€â€ï¼Œä½ ç”¨ç¡®å®šæ€§ç®—æ³•â€œæœ€åé˜²æŠ–â€ï¼Œä¿è¯ä¸é‡å ã€‚
- **æ ‡å‡†/å…¬å·®**ï¼šè®© LLM æŒ‰â€œæœ€å°å¯è¡Œé›†â€äº§å‡ºæ–‡æœ¬ï¼Œä½†æ˜ç¡®â€œéœ€ç¡®è®¤â€é¡¹ï¼Œé¿å…è¶Šæƒå†³ç­–ã€‚

------

### 6) ä¸ Inventor API çš„å¯¹æ¥è¦ç‚¹ï¼ˆæçº²ï¼‰

- **è·å–å‡ ä½•**ï¼š`Face.SurfaceType / Face.Geometry`ã€`Edge.Geometry`ã€`Face.Evaluator`ï¼ˆæ³•å‘ã€å‚æ•°åŸŸã€é¢ç§¯ï¼‰ã€`Body.Faces/Edges`ï¼›
- **ç›¸é‚»å…³ç³»**ï¼š`Face.EdgeLoops -> Edges -> AdjacentFaces`ï¼›
- **ç‰¹å¾æ ‘**ï¼š`PartComponentDefinition.HoleFeatures / ThreadFeatures / FilletFeatures ...`ï¼›
- **å¼•ç”¨æŒä¹…åŒ–**ï¼šä½¿ç”¨ **ReferenceKey** ä¿å­˜é€‰ä¸­é¢/è¾¹ï¼ˆé¿å…é‡ç®—å¤±æ•ˆï¼‰ã€‚
- 
- **ç»˜åˆ¶**ï¼šåœ¨ Drawing æ–‡æ¡£æˆ– 3D æ³¨é‡Šï¼ˆPMIï¼‰é‡Œæ”¾ç½®å°ºå¯¸ã€æ³¨é‡Šã€å¼•å‡ºçº¿ï¼›æ”¯æŒåæ ‡è½¬æ¢ï¼ˆæ¨¡å‹åæ ‡â†’è§†å›¾åæ ‡ï¼‰ã€‚











# æ›´ç®€æ´çš„æ€è·¯ 



### 0) æ€»ä½“æµæ°´çº¿ï¼ˆä¸‰æ®µï¼‰

1. **æŠ½å–å™¨ï¼ˆExtractorï¼Œå›ºå®šä»£ç ï¼‰**
    ä»å½“å‰é›¶ä»¶/å·¥ç¨‹å›¾é‡Œå¯¼å‡ºä¸€ä¸ª**è§„èŒƒåŒ– JSON**ï¼šåŒ…å«è½´åˆ†æ®µã€ç‰¹å¾ï¼ˆèºçº¹/å€’è§’/é”®æ§½â€¦ï¼‰ã€è§†å›¾/æ¯”ä¾‹ã€**æ¨¡å‹å‚æ•°å**ï¼ˆæˆ–ä½ æ‰“çš„ Attribute æ ‡ç­¾ï¼‰ç­‰ã€‚
2. **å†³ç­–å™¨ï¼ˆLLMï¼Œå¤§æ¨¡å‹ï¼‰**
    è¾“å…¥ä¸Šé¢çš„ JSON + ä½ çš„æ’ç‰ˆçº¦æŸ â†’ è®© LLM äº§å‡ºä¸€ä¸ª**â€œæ ‡æ³¨è®¡åˆ’â€ JSON**ï¼š

- æ ‡æ³¨ç±»å‹ï¼ˆç›´å¾„/é•¿åº¦/è§’åº¦/å…¬å·®/ç²—ç³™åº¦/åŸºå‡†â€¦â€¦ï¼‰
- ç»‘å®šç›®æ ‡ï¼ˆå‚æ•°å or å‡ ä½•æ ‡ç­¾ï¼‰
- æ–‡æœ¬ï¼ˆå¦‚â€œâŒ€30 h7â€ã€â€œRa1.6â€ã€â€œM24Ã—2-6gÃ—30â€ï¼‰
- åæ ‡/å¼•çº¿å»ºè®®ï¼ˆä¸æŒ¤ã€å°½é‡ä¸Šæ–¹â€¦ï¼‰

1. **æ¸²æŸ“å™¨ï¼ˆRendererï¼Œå›ºå®šä»£ç ï¼‰**
    è¯»å–â€œæ ‡æ³¨è®¡åˆ’â€ JSONï¼Œè°ƒç”¨ Inventor APIï¼š

- è§†å›¾ï¼š`AddBaseView / AddProjectedView`
- å°ºå¯¸ï¼š`DrawingDimensions` å®¶æ—ï¼ˆå¹¶è®¾ç½® `Tolerance/Precision/Text`ï¼‰
- ç¬¦å·ï¼š`SurfaceTextureSymbol / FeatureControlFrame / DatumIdentifierSymbol`
- å®šä½ï¼šç”¨ `GeometryIntent/ModelToDrawingViewSpace` æŠŠ LLM ç»™çš„ç›®æ ‡ä¸åæ ‡è½å®ã€‚

å¤§æ¨¡å‹**ä¸è®­ç»ƒ**ï¼Œä¸æ¶‰åŠ lossï¼›å®ƒåªåšâ€œæ£€ç´¢+æ¨ç†+å JSONâ€ã€‚

------

### 1) ä½ å–‚ç»™å¤§æ¨¡å‹çš„è¾“å…¥ JSONï¼ˆæœ€å°å¯ç”¨ç‰ˆï¼‰

```
{
  "meta": { "part_name": "shaft_A01", "units": "mm", "view": "front", "scale": 1.0 },
  "segments": [
    { "id": "seg1", "z_from": 0, "z_to": 30, "diam_param": "D_seg1", "has_fillet": 2 },
    { "id": "seg2", "z_from": 30, "z_to": 120, "diam_param": "D_seg2", "chamfer": {"len": 1, "ang": 45} },
    { "id": "seg3", "z_from": 120, "z_to": 200, "diam_param": "D_seg3", "thread": {"spec_param": "TH_seg3", "pitch": 2, "len": 30} }
  ],
  "features": {
    "keyways": [ { "id": "kw1", "z_center": 60, "w": 8, "depth": 3, "len": 20 } ]
  },
  "parameters": [
    { "name": "D_seg1", "expr": "40 mm" },
    { "name": "D_seg2", "expr": "30 mm" },
    { "name": "D_seg3", "expr": "25 mm" },
    { "name": "TH_seg3", "expr": "M24x2-6g" }
  ],
  "layout_rules": { "no_overlap": true, "min_gap": 6, "prefer_side": "top" }
}
```

è¦ç‚¹ï¼š

- **ç»‘å®šæ¡¥**ï¼`parameters[].name` æˆ–ä½ ç»™å‡ ä½•æ‰“çš„ **Attribute**ï¼ˆæ¯”å¦‚ `Face.AttributeSets("seg").Item("seg2")`ï¼‰ï¼›
- ä»¥åæ¸²æŸ“æ—¶å°±èƒ½ç²¾å‡†æ‰¾åˆ°å¯¹åº”å°ºå¯¸/å‡ ä½•ã€‚

------

### 2) è®©å¤§æ¨¡å‹è¾“å‡ºçš„â€œæ ‡æ³¨è®¡åˆ’â€ JSONï¼ˆä½ åœ¨ç½‘é¡µç«¯ä¹Ÿèƒ½ç”¨â€œåªè¾“å‡º JSONâ€çº¦æŸå®ƒï¼‰

```
{
  "dimensions": [
    { "type": "diameter", "target_param": "D_seg1", "text": "âŒ€40 h7", "text_pos": [120, 35] },
    { "type": "linear",   "targets": ["seg1.z_from","seg1.z_to"], "text": "30", "text_pos": [40, -8] },
    { "type": "thread_note", "target_param": "TH_seg3", "text": "M24Ã—2-6g Ã—30", "text_pos": [180, 26] }
  ],
  "symbols": [
    { "type": "surface_texture", "target": "seg2.cyl_surface", "text": "Ra 1.6", "text_pos": [95, 22] },
    { "type": "datum", "name": "A", "text_pos": [5, 5] }
  ]
}
```

> ç›´å¾„/é•¿åº¦å±äº **DrawingDimensions**ï¼›ç²—ç³™åº¦/åŸºå‡†å±äº **Symbols**ã€‚

------

### 3) æ¸²æŸ“å™¨æ€ä¹ˆè½åœ°ï¼ˆä¸¤æ¡å¸¸ç”¨è·¯å­ï¼‰

#### è·¯å­ Aï¼š**â€œæ¨¡å‹ç»´åº¦â†’å·¥ç¨‹å›¾æ£€ç´¢â€**ï¼ˆç¨³ã€å®ç°å¿«ï¼‰

1. åœ¨ 3D æ¨¡å‹é‡ŒæŠŠå…³é”®å°ºå¯¸**å‘½åå‚æ•°**ï¼ˆå¦‚ `D_seg2`ï¼‰ã€‚
2. å·¥ç¨‹å›¾é‡Œå¯¹è§†å›¾è°ƒç”¨**æ£€ç´¢æ¨¡å‹å°ºå¯¸**ï¼ˆRetrieve Dimensionsï¼‰ã€‚
3. éå† `DrawingDimensions`ï¼ŒæŒ‰ `ReferencedParameter.Name` åŒ¹é…åˆ°è®¡åˆ’é‡Œçš„ `target_param`ï¼Œè®¾ç½®ï¼š
   - `Dimension.Tolerance`ï¼ˆå…¬å·®ï¼‰
   - `Dimension.Text.FormattedText`ï¼ˆåŠ  âŒ€ã€åç¼€ç­‰ï¼‰
   - `Dimension.Text.Position`ï¼ˆæ”¾åˆ° LLM å»ºè®®åæ ‡ï¼‰

> ä¼˜ç‚¹ï¼šä¸éœ€è¦ä½ å»â€œæ‰¾è¾¹æ‰¾ç‚¹â€ï¼Œåˆ©ç”¨å·²æœ‰**æ¨¡å‹å°ºå¯¸**åšæ¡¥æ¥ï¼Œæç¨³ã€‚

**iLogic ç‰‡æ®µï¼ˆç¤ºä¾‹ï¼Œæ¼”ç¤ºæ£€ç´¢å¹¶ç§»åŠ¨åŒ¹é…å‚æ•°çš„å°ºå¯¸ï¼‰ï¼š**

```
Dim drw As DrawingDocument = ThisApplication.ActiveDocument
Dim sheet As Sheet = drw.ActiveSheet
Dim view As DrawingView = sheet.DrawingViews.Item(1)

' 1) æ£€ç´¢æ¨¡å‹å°ºå¯¸åˆ°è¯¥è§†å›¾ï¼ˆä¸åŒç‰ˆæœ¬æ¥å£ç•¥æœ‰å·®å¼‚ï¼Œå¦‚å¤±è´¥è¯·æ‰‹åŠ¨èœå•æ£€ç´¢ä¸€æ¬¡ç¡®è®¤æ¨¡æ¿ï¼‰
view.RetrieveDimensions()

' 2) å‡è®¾æˆ‘ä»¬è¦æŠŠåä¸º D_seg2 çš„å°ºå¯¸ç§»åŠ¨åˆ°(100, 30)
Dim targetParamName As String = "D_seg2"
Dim newPos As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(100, 30)

For Each dimObj As DrawingDimension In sheet.DrawingDimensions
    On Error Resume Next
    Dim p As Parameter = dimObj.ReferencedParameter
    If Not p Is Nothing Then
        If String.Equals(p.Name, targetParamName, StringComparison.OrdinalIgnoreCase) Then
            ' è®¾ç½®æ–‡æœ¬ï¼ˆå¯åŒ…å« âŒ€ã€åç¼€ï¼‰
            dimObj.Text.FormattedText = "âŒ€30 h7"
            ' è®¾ç½®ä½ç½®
            dimObj.Text.Position = newPos
            Exit For
        End If
    End If
Next
```

> è¯´æ˜ï¼šä¸åŒç‰ˆæœ¬é‡Œ `RetrieveDimensions()` çš„å…¥å£å¯èƒ½åœ¨ `DrawingView` æˆ– `DrawingDocument.SelectSet` çš„å®ç”¨å·¥å…·é‡Œï¼›å¦‚æœè¯¥è¡ŒæŠ¥æ¥å£ä¸å­˜åœ¨ï¼Œä½ å¯ä»¥æ‰‹åŠ¨å…ˆâ€œå·¥ç¨‹å›¾â†’åŸºè§†å›¾å³é”®â†’æ£€ç´¢æ¨¡å‹å°ºå¯¸â€ç¡®è®¤åŠŸèƒ½å¯ç”¨ï¼Œå†æŠŠè°ƒç”¨æ¢æˆä½ ç‰ˆæœ¬æ”¯æŒçš„æ–¹å¼ï¼ˆæ€è·¯ç›¸åŒï¼šå…ˆæŠŠæ¨¡å‹å°ºå¯¸æ‹‰åˆ°è§†å›¾ä¸Šï¼Œå†ç¼–ç¨‹ç§»åŠ¨/æ”¹æ ·å¼ï¼‰ã€‚

#### è·¯å­ Bï¼š**â€œå‡ ä½•æ ‡ç­¾â†’GeometryIntentâ€**ï¼ˆæ›´çµæ´»ï¼ŒåæœŸè¿›é˜¶ï¼‰

- åœ¨ Part é‡Œç»™å…³é”®**é¢/è¾¹**æ‰“ `AttributeSets`ï¼ˆä¾‹å¦‚ç»™ seg2 çš„åœ†æŸ±é¢æ‰“ `seg_id="seg2"`ï¼‰ï¼›
- å·¥ç¨‹å›¾è§†å›¾ä¸­é€šè¿‡ `DrawingView.ModelGeometry` åæŸ¥è¿™äº›å¸¦æ ‡ç­¾çš„å‡ ä½•ï¼Œæ„é€  `GeometryIntent`ï¼›
- ç”¨ `GeneralDimensions.Addâ€¦`ï¼ˆç›´å¾„/çº¿æ€§/è§’åº¦ï¼‰ä¼ å…¥å‡ ä½•æ„å›¾åˆ›å»ºæ–°å°ºå¯¸ã€‚

> ä¼˜ç‚¹ï¼šä¸ä¾èµ–â€œå·²æœ‰æ¨¡å‹å°ºå¯¸â€ï¼Œå®Œå…¨è‡ªåŠ¨ï¼›ç¼ºç‚¹ï¼šå‰æœŸéœ€è¦æ‰“æ ‡ç­¾ä¸å‡ ä½•åŒ¹é…ä»£ç ã€‚

------

### 4) ç¬¦å·ç±»ï¼ˆç²—ç³™åº¦/å½¢ä½/åŸºå‡†ï¼‰å¾ˆé€‚åˆå…ˆè·‘é€š

è¿™äº›ä¸éœ€è¦å¼•ç”¨å…·ä½“â€œè¾¹/ç‚¹â€çš„æˆå¯¹å‡ ä½•ï¼Œæ›´å®¹æ˜“ç”¨ LLM çš„ `text_pos` ç›´æ¥è½åœ°ã€‚

**ç²—ç³™åº¦ç¬¦å· iLogic æœ€å°ç¤ºä¾‹ï¼š**

```
Dim drw As DrawingDocument = ThisApplication.ActiveDocument
Dim sheet As Sheet = drw.ActiveSheet
Dim st As SurfaceTextureSymbol
Dim pos As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(95, 22)

' åœ¨å›¾çº¸åæ ‡æ”¾ä¸€ä¸ª Ra1.6ï¼ˆä¹Ÿå¯ä»¥ç”¨ View çš„åæ ‡è½¬æ¢æ–¹æ³•å…ˆåœ¨æ¨¡å‹ç©ºé—´å®šç‚¹ï¼Œå†æ˜ å°„å›å›¾çº¸ï¼‰
st = sheet.DrawingNotes.SurfaceTextureSymbols.Add(pos)
st.Text = "Ra 1.6"
```

**åŸºå‡†ç¬¦å·ï¼š**

```
Dim db As DatumIdentifierSymbol
Dim p As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(5, 5)
db = sheet.DrawingNotes.DatumIdentifierSymbols.Add(p, "A")
```

> å…ˆæŠŠâ€œç¬¦å·ç±»â€è·‘é€šï¼Œä½ å°±æœ‰â€œè‡ªåŠ¨æ ‡æ³¨â€çš„å¯è§æˆæœï¼›éšåå†æ”»â€œå°ºå¯¸ç±»â€çš„å‚æ•°/å‡ ä½•ç»‘å®šã€‚

------

### 5) è®©å¤§æ¨¡å‹â€œåªå JSONâ€çš„æç¤ºè¯éª¨æ¶ï¼ˆç½‘é¡µç«¯ä¹Ÿå¯ç”¨ï¼‰

```
ä½ æ˜¯æœºæ¢°å·¥ç¨‹å›¾è‡ªåŠ¨æ ‡æ³¨åŠ©æ‰‹ã€‚åªè¾“å‡ºåˆæ³• JSONï¼Œä¸è¦ä»»ä½•è§£é‡Šã€‚
è¾“å…¥æ˜¯æ¨¡å‹æŠ½è±¡ JSONï¼ˆsegments, parameters, features, layout_rulesï¼‰ã€‚
è¯·è¾“å‡ºæ ‡æ³¨è®¡åˆ’ JSONï¼Œå­—æ®µï¼šdimensions[], symbols[]ï¼Œæ¯æ¡åŒ…å«ï¼š
- typeï¼ˆdiameter/linear/angle/thread_note/surface_texture/datum/...ï¼‰
- target_param æˆ– targetï¼ˆå‡ ä½•/æ®µIDï¼‰
- textï¼ˆæœ€ç»ˆæ ‡æ³¨æ–‡å­—ï¼Œå«å…¬å·®/ç¬¦å·ï¼‰
- text_posï¼ˆ[x,y]ï¼Œå•ä½ä¸è¾“å…¥ä¸€è‡´ï¼‰
ç¡®ä¿ä¸é‡å ï¼Œå°½é‡æ”¾åœ¨è§†å›¾ä¸Šæ–¹ã€‚
```

> å¦‚æœå®ƒå¶å°”â€œå¤šå˜´â€ï¼Œç”¨æ­£åˆ™æå–æœ€å¤–å±‚ `{â€¦}` å† `json.loads()`ï¼›å¤±è´¥å°±è®©å®ƒé‡æ¥ä¸€æ¬¡ã€‚

------

### 6) ä½ ç°åœ¨å¯ä»¥æ€ä¹ˆè½åœ°ï¼ˆå»ºè®®é¡ºåºï¼‰

1. **å…ˆèµ°è·¯å­ A**ï¼šæŠŠå…³é”®ç›´å¾„/é•¿åº¦**å‘½åå‚æ•°** â†’ åœ¨å·¥ç¨‹å›¾é‡Œ**æ£€ç´¢æ¨¡å‹å°ºå¯¸** â†’ ç”¨ä¸Šé¢çš„å¾ªç¯**æŒ‰å‚æ•°åç§»åŠ¨/æ”¹æ–‡æœ¬**ã€‚
2. **ç¬¦å·ç±»å…ˆä¸Š**ï¼šç²—ç³™åº¦/åŸºå‡†/å½¢ä½ç”¨ `DrawingNotes.*Symbols.Add()`ï¼Œå®Œå…¨ä¸éš¾ã€‚
3. å†è€ƒè™‘**å…¬å·®**ï¼š`DrawingDimension.Tolerance` + æ ·å¼ï¼ˆDimension Stylesï¼‰ã€‚
4. éœ€è¦â€œå…¨è‡ªåŠ¨æ— æ¨¡å‹å°ºå¯¸â€æ—¶ â†’ ä¸Š**è·¯å­ Bï¼ˆå‡ ä½•æ ‡ç­¾+GeometryIntentï¼‰**ã€‚

------

å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥æŒ‰ä½ ç°åœ¨çš„ Inventor ç‰ˆæœ¬ï¼Œç»™ä½ ï¼š

- ä¸€ä¸ª**æŠ½å–å™¨**ï¼ˆå¯¼å‡ºå‚æ•°å/æ®µä¿¡æ¯çš„ iLogic ä»£ç ï¼‰ï¼›
- ä¸€ä¸ª**æ¸²æŸ“å™¨**ï¼ˆè¯»å–â€œæ ‡æ³¨è®¡åˆ’ JSONâ€ï¼Œæ£€ç´¢æ¨¡å‹å°ºå¯¸å¹¶ç§»åŠ¨æ”¹å­— + åŠ ç²—ç³™åº¦/åŸºå‡†ç¬¦å·ï¼‰çš„ iLogic æ¨¡æ¿ã€‚

è¿™æ ·ä½ å°±èƒ½è·‘é€šâ€œ**æŠ½å– â†’ LLM å†³ç­– â†’ è½åœ°**â€çš„é—­ç¯äº†ã€‚







# Inventorå­¦ä¹ 



| æ¨¡å¼/ä½ç½®             | ä»£ç å½¢æ€                                                   | è¿è¡Œåœ¨å“ªé‡Œ                      | å…¸å‹ç”¨é€”                              | ä¼˜åŠ¿                                            | å±€é™                                                         |
| --------------------- | ---------------------------------------------------------- | ------------------------------- | ------------------------------------- | ----------------------------------------------- | ------------------------------------------------------------ |
| **Standalone EXE**    | ç‹¬ç«‹å¯æ‰§è¡Œç¨‹åºï¼ˆC#/VB/C++ ç­‰ï¼‰é€šè¿‡ COM è‡ªåŠ¨åŒ–è¿æ¥ Inventor | Inventor è¿›ç¨‹**å¤–éƒ¨**           | æ‰¹å¤„ç†ã€å·¥å…·é“¾æ•´åˆã€å‘½ä»¤è¡Œ/GUI å·¥å…·   | æ˜“éƒ¨ç½²ã€å¯ç‹¬ç«‹è¿è¡Œï¼›å¯æ‹‰èµ·æˆ–è¿æ¥å·²å¼€çš„ Inventor | UI äº¤äº’ä¸å¦‚å†…ç½®æ’ä»¶é¡ºç•…ï¼›è¦è‡ªå·±ç®¡ç†è¿›ç¨‹/ä¼šè¯                 |
| **Addâ€‘In (DLL)**      | COM æ’ä»¶ï¼Œå®ç° `ApplicationAddInServer`                    | Inventor è¿›ç¨‹**å†…éƒ¨**           | åœ¨ Ribbon åŠ æŒ‰é’®/é¢æ¿ï¼Œæ·±åº¦é›†æˆå·¥ä½œæµ | UI é›†æˆæœ€å¥½ï¼›èƒ½å“åº”å¤§é‡äº‹ä»¶ï¼›æ€§èƒ½å¥½             | éœ€è¦æ³¨å†Œ/åŠ è½½ï¼›ç‰ˆæœ¬å…¼å®¹è¦æ³¨æ„                                |
| **VBA/ilogic**        | åµŒå…¥æ–‡æ¡£æˆ–å…¨å±€çš„ VBA å®                                    | Inventor **å†…éƒ¨**ï¼ˆVBA å®¿ä¸»ï¼‰   | å¿«é€Ÿè„šæœ¬ã€å½•åˆ¶å®ã€ä¸€æ¬¡æ€§çš„å°å·¥å…·      | ä¸Šæ‰‹æœ€å¿«ï¼›ä¸éœ€ VS ç¯å¢ƒ                          | ç»´æŠ¤å’Œåä½œå·®ï¼›IDE èƒ½åŠ›å¼±ï¼›é€æ­¥è¢« .NET/iLogic å–ä»£            |
| **Apprentice Server** | æ— ç•Œé¢ï¼ˆheadlessï¼‰çš„ COM åº“                                | ä½ çš„åº”ç”¨è¿›ç¨‹å†…ï¼ˆ**ä¸å¯åŠ¨ UI**ï¼‰ | è¯»å–/å†™å…¥æ¨¡å‹å’Œ iPropertyï¼Œæ‰¹é‡æ£€ç´¢   | ä¸éœ€è¦å¼€ Inventorï¼›è¯»å†™è½»é‡ã€é€‚åˆæœåŠ¡å™¨         | **ä¸èƒ½åˆ›å»º/ç¼–è¾‘å·¥ç¨‹å›¾ã€è‰å›¾å’Œå¤§å¤šæ•°ç»˜å›¾æ ‡æ³¨**ï¼›å‡ ä½•ç¼–è¾‘èƒ½åŠ›æœ‰é™ |

> åº•éƒ¨çš„ **Inventor Data**ï¼ˆæ–‡ä»¶åº“ï¼‰å¯¹ä¸Šé¢æ‰€æœ‰å½¢æ€å¼€æ”¾ï¼šAddâ€‘In/VBA/Standalone éƒ½å¯ä»¥é€šè¿‡ UI ç‰ˆ Inventor è¯»å†™ï¼›Apprentice åˆ™åœ¨ä¸å°‘ç»˜å›¾/æ ‡æ³¨èƒ½åŠ›ä¸Šå—é™ï¼ˆè¯»å¤šå†™å°‘ï¼‰ã€‚

- **iLogic = å†…ç½®åœ¨ Inventor é‡Œçš„â€œè§„åˆ™å¼•æ“ + è„šæœ¬å±‚â€**ï¼ˆè¯­æ³•æ¥è¿‘ VB.NETï¼‰ã€‚å®ƒ**ä¸å•ç‹¬ä½œä¸ºä¸€ä¸ªæ¡†**å‡ºç°åœ¨è¿™å¼ è€å›¾é‡Œï¼Œä½†æœ¬è´¨ä¸Šå±äºâ€œ**Inventor å†…éƒ¨è„šæœ¬**â€ï¼Œå’Œ VBA ä¸€æ ·è·‘åœ¨åº”ç”¨å†…ï¼Œåªæ˜¯ï¼š
  - æœ‰ä¸“é—¨çš„è§„åˆ™ç®¡ç†å™¨ã€äº‹ä»¶è§¦å‘ï¼ˆæ–‡æ¡£æ‰“å¼€/ä¿å­˜/å‚æ•°å˜åŒ–ç­‰ï¼‰ï¼Œæ›´é€‚åˆåšå‚æ•°åŒ–ã€é…ç½®åŒ–é©±åŠ¨ã€‚
  - èƒ½ç›´æ¥è®¿é—® `ThisApplication/ThisDoc` ç­‰å¯¹è±¡ï¼ŒåŒæ ·è°ƒç”¨**åŒä¸€å¥— COM API**ã€‚
  - å¯ä¸ Addâ€‘In é…åˆï¼šiLogic å¯ä»¥è°ƒç”¨ä½ æ’ä»¶æš´éœ²çš„å…¬å¼€æ–¹æ³•ï¼›Addâ€‘In ä¹Ÿèƒ½è§¦å‘/ç®¡ç† iLogic è§„åˆ™ã€‚
- ç®€å•ç†è§£ï¼š
  - **VBA**ï¼šä¼ ç»Ÿè„šæœ¬å±‚ã€‚
  - **iLogic**ï¼šç°ä»£åŒ–ã€å·¥ç¨‹åŒ–ç¨‹åº¦æ›´é«˜çš„è„šæœ¬å±‚ï¼Œå’Œå…¬å¸è§„åˆ™/å‚æ•°åŒ–å¼ºç»‘å®šã€‚
  - ä¸¤è€…éƒ½è¿è¡Œåœ¨ **Inventor å†…éƒ¨**ï¼Œéƒ½é åŒä¸€å¯¹è±¡æ¨¡å‹åŠäº‹ï¼›åªæ˜¯ iLogic é›†æˆæ›´æ·±ã€æ›´é€‚åˆâ€œè§„åˆ™é©±åŠ¨è®¾è®¡â€ã€‚







Ilogic:æ— æ³•ç»˜åˆ¶å›¾å½¢ï¼Œåªèƒ½å¯¹å›¾å½¢è¿›è¡Œç¼–è¾‘ ç”¨äºå†™æ ‡æ³¨åˆšåˆšå¥½





æ ‡å¤šå°‘ï¼šÃ—

æ ‡å“ªäº›å‚æ•°ï¼šÃ—



æ ‡åœ¨å“ªï¼šè¾“å…¥æ•´ç†å¥½çš„å‚æ•°åŠå…¶åæ ‡       è¾“å‡ºåæ ‡



ç¡®å®šéœ€æ±‚ï¼š

## è¾“å…¥æ˜¯å’Œæ ‡æ³¨å‚æ•°æœ‰å…³çš„ä½ç½®ä¿¡æ¯ï¼Œè¾“å‡ºæ˜¯æ ‡æ³¨çš„ç»“æœå’Œåæ ‡  æ–‡å­—ä¹‹é—´çš„æ˜ å°„ ä¸­é—´äº¤ç»™AI

ç°åœ¨çš„é—®é¢˜æ˜¯ï¼šç†æ¸…æ¥šè¿™æ¡çº¿æ€ä¹ˆèµ°



ç»“è®ºå…ˆè¯´ï¼š**å¯è¡Œ**ï¼Œä½†æœ€å¥½æ˜¯â€œæ··åˆå¼â€ã€‚
 ä½ å®Œå…¨å¯ä»¥æŠŠ**ç²¾ç¡®çœŸå€¼å’Œå€™é€‰é”šç‚¹ä½ç½®**éƒ½ä» Inventor æ‹¿å‡ºæ¥å–‚ç»™å¤§æ¨¡å‹ï¼›å¤§æ¨¡å‹å†**æ‰¹é‡**äº§å‡ºâ€œè¯¥å†™ä»€ä¹ˆæ–‡æœ¬ + æ”¾å“ªä¸€ä¾§/ç›¸å¯¹åç§»ï¼ˆæˆ–å»ºè®®åæ ‡ï¼‰â€ï¼›æœ€åç”±ä½ çš„æ’ä»¶**è¿›è¡Œåæ ‡è½åœ°ä¸ç¢°æ’æ ¡éªŒ**ã€‚
 ä¸‹é¢æŒ‰ä½ å…³å¿ƒçš„ä¸¤ä»¶äº‹æ¥ç­”ï¼šâ‘ è¿™äº›æ•°æ®åœ¨ Inventor é‡Œéƒ½èƒ½ä¸èƒ½æ‹¿åˆ°ï¼›â‘¡å¤§æ¨¡å‹èƒ½ä¸èƒ½ä¸€æ¬¡ç”Ÿæˆå¤šæ¡æ ‡æ³¨å’Œå€¼+åæ ‡ã€‚

------

## 1) ä½ èƒ½ä» Inventor æ‹¿åˆ°å“ªäº›â€œå¯å–‚ç»™æ¨¡å‹çš„æ•°æ®â€

ï¼ˆéƒ½èƒ½æ‹¿ï¼Œæ‹¬å·é‡Œæ˜¯è·å–æ€è·¯/å¯¹è±¡åç§°ï¼Œå…ˆç†è§£ï¼Œä¸ç”¨è®°æ–¹æ³•åï¼‰

- **å‡ ä½•çœŸå€¼ï¼ˆmmï¼‰**ï¼šç›´å¾„/åŠå¾„/é•¿åº¦/è§’åº¦ç­‰
  - æ¥è‡ªæ¨¡å‹å‚æ•°ï¼ˆModelParameterï¼‰æˆ–æµ‹é‡ï¼ˆMeasureTools å¯¹ Edge/Face æµ‹ï¼‰
- **é”šç‚¹ä¸åŸºå…ƒ**ï¼šåœ†å¿ƒã€è¾¹ä¸­ç‚¹ã€ç‰¹å¾çº¿ç«¯ç‚¹ã€è½®å»“å¤–æ¥æ¡†
  - 3Dï¼šé€‰å®š Face/Edge åå–å…³é”®ç‚¹ï¼›2Dï¼šDrawingCurveSegment ä¹Ÿæœ‰å‡ ä½•ç‚¹/å¤–æ¥æ¡†
- **è§†å›¾ä¸åæ ‡ç³»æ˜ å°„**ï¼šæŠŠ 3D ç‚¹æŠ•åˆ°è¯¥è§†å›¾çš„ 2D â€œå›¾çº¸åæ ‡â€ï¼ˆsheet mmï¼‰
  - DrawingView æä¾›è§†å›¾æ¯”ä¾‹ä¸å˜æ¢ï¼ˆæœ‰æŠ•å½±/æ¯”ä¾‹ä¿¡æ¯ï¼›å¯æŠŠæ¨¡å‹ç‚¹è½¬ä¸ºè§†å›¾/å›¾çº¸ç‚¹ï¼‰
- **ç‰ˆé¢è¾¹ç•Œ**ï¼šå›¾çº¸å¯ç”¨åŒºåŸŸï¼ˆSheet å°ºå¯¸/è¾¹è·ï¼‰
- **å·²æœ‰æ ‡æ³¨çš„åŒ…å›´æ¡†**ï¼šå·²æ”¾ç½®çš„ Leader/Note çš„å¤–æ¥æ¡†ï¼Œé¿å…ç¢°æ’
- **æ–‡æœ¬æ ·å¼åº¦é‡**ï¼šå­—å·ã€ç®­å¤´å¤§å°ã€è¡Œè·ï¼ˆDrawingStylesManager/å½“å‰æ ·å¼ï¼‰

> æœ‰äº†è¿™äº›ï¼Œä½ å°±èƒ½æ„é€ **ç»“æ„åŒ–è¾“å…¥**ï¼šæ¯ä¸ªâ€œå¾…æ ‡æ³¨å‚æ•°â€çš„ idã€çœŸå®æ•°å€¼ã€å•ä½ã€é”šç‚¹åœ¨**å›¾çº¸åæ ‡**ä¸­çš„ä½ç½®/å¤–æ¥æ¡†ï¼Œé¡µé¢è¾¹ç•Œã€ç°æœ‰æ ‡æ³¨å ä½ç­‰ã€‚

------

## 2) å¤§æ¨¡å‹èƒ½å¦ä¸€æ¬¡ç”Ÿæˆâ€œå¤šä¸ªå‚æ•°çš„æ–‡æœ¬ä¸åæ ‡â€

- **èƒ½**ï¼Œä½†å¼ºçƒˆå»ºè®®ï¼š
  - è®©æ¨¡å‹è¾“å‡º**â€œæ–‡æœ¬+æ”¾ç½®ç­–ç•¥â€**ï¼ˆå¦‚ side=rightã€offset_level=2ã€ä¼˜å…ˆçº§é¡ºåºã€æ˜¯å¦ä¸è°åˆå¹¶æˆä¸€æ¡ï¼‰
  - ç”±ä½ çš„æ’ä»¶**æœ€ç»ˆè®¡ç®—ç»å¯¹åæ ‡**å¹¶åš**ç¢°æ’/è¶Šç•Œæ ¡éªŒä¸å›é€€**ã€‚
- å¦‚æœä½ åšæŒè®©æ¨¡å‹ç»™å‡º**ç»å¯¹åæ ‡**ä¹Ÿå¯ä»¥ï¼Œä½†è¦åšä¸¤æ­¥**åˆšæ€§æ ¡éªŒ**ï¼š
  1. åˆæ³•æ€§ï¼šåœ¨çº¸å†…ã€å•ä½æ­£ç¡®ã€æ ¼å¼æ­£ç¡®ï¼›
  2. ç‰©ç†å¯æ”¾ï¼šä¸å‡ ä½•/å·²æœ‰æ ‡æ³¨ä¸é‡å ï¼›ä¸å¯æ”¾åˆ™æŒ‰ä½ è§„åˆ™äºŒæ¬¡è°ƒæ•´ã€‚





# Inventorå¸®åŠ©æ–‡æ¡£é˜…è¯»

## ä¸€ï¼ŒåŸºæœ¬æ¦‚å¿µ

### 1 ä½¿ç”¨è®¡é‡å•ä½

Inventor æ˜¾ç¤ºå’Œè¾“å…¥ç”¨çš„æ˜¯ä½ è®¾ç½®çš„é»˜è®¤å•ä½ï¼Œä½†åº•å±‚ä¸€ç›´ç”¨å›ºå®šçš„å†…éƒ¨å•ä½ï¼ˆæ¯”å¦‚ cmï¼‰å’Œé«˜ç²¾åº¦ double æ¥è®¡ç®—ï¼Œæ‰€ä»¥æ”¹å•ä½ä¸ä¼šæ”¹å˜æ¨¡å‹æœ¬è´¨ã€‚



ç›¸å…³çš„ç±»æ˜¯`UnitsOfMeasure` 

`UnitsOfMeasure` ä¸ä»…èƒ½æ”¹é»˜è®¤æ˜¾ç¤ºå•ä½ï¼Œè¿˜èƒ½å¸®ä½ æŠŠç”¨æˆ·è¾“å…¥çš„ä»»æ„å€¼ï¼ˆå¸¦å•ä½æˆ–ä¸å¸¦å•ä½ï¼‰å®‰å…¨åœ°è½¬æ¢æˆ Inventor å†…éƒ¨ç»Ÿä¸€ä½¿ç”¨çš„æ•°æ®åº“å•ä½ï¼ˆæ¯”å¦‚é•¿åº¦æ°¸è¿œæ˜¯å˜ç±³ï¼‰ã€‚





è¿™ä¸ªç±»è¿˜å¯ä»¥è¡¨ç¤ºå¤åˆçš„è‡ªåˆ›å•ä½ æ¯”å¦‚ä½“ç§¯  å…·ä½“ä¾‹å­ç­‰éœ€è¦å†å»ç ”ç©¶





### 2 ç¬æ€å‡ ä½•ã€çŸ©é˜µå’Œå‘é‡

**Transient Geometry = API é‡Œçš„æ•°å­¦å·¥å…·ç®±**ï¼Œç”¨æ¥åˆ›å»ºå’Œè¿ç®—ç‚¹ã€å‘é‡ã€çŸ©é˜µç­‰ä¸´æ—¶å‡ ä½•æ•°æ®ï¼Œå¸®ä½ å®šä½ã€è®¡ç®—ã€æ“ä½œçœŸæ­£çš„æ¨¡å‹å¯¹è±¡ï¼Œä½†å®ƒä»¬æœ¬èº«åœ¨æ¨¡å‹ä¸­æ˜¯çœ‹ä¸åˆ°çš„ã€ä¸ä¼šä¿å­˜çš„ã€‚



é€šè¿‡ `ThisApplication.TransientGeometry` æä¾›çš„æ–¹æ³•æ¥åˆ›å»ºï¼Œæ¯”å¦‚ï¼š

- `CreatePoint2d(x, y)`
- `CreatePoint(x, y, z)`
- `CreateVector(x, y, z)`
- `CreateMatrix()`

è¿™äº›æ–¹æ³•ä¸ä¼šåœ¨æ¨¡å‹é‡Œç”Ÿæˆå®ä½“ï¼Œåªä¼šå¾—åˆ°ä¸€ä¸ªæ•°å­¦å¯¹è±¡ã€‚



è¿™ä¸ªåŠŸèƒ½å¯ä»¥ç”¨æ¥åŠ æ ‡æ³¨

åœ¨ Inventor API é‡Œï¼Œ**æ ‡æ³¨çš„â€œæµ‹é‡å¯¹è±¡â€å’Œâ€œæ”¾ç½®ä½ç½®â€æ˜¯åˆ†å¼€çš„**ï¼š

1. **æµ‹é‡å¯¹è±¡ï¼ˆå‡ ä½•å¼•ç”¨ï¼‰**
   - å†³å®šæ ‡æ³¨æ˜¾ç¤ºçš„æ•°å€¼ï¼Œæ¯”å¦‚è½´çš„ä¸¤ä¸ªç«¯é¢ã€‚
   - ä½ é€šè¿‡é€‰æ‹© `Edge`ã€`Face`ã€`Vertex` è¿™ç§å‡ ä½•å¼•ç”¨æ¥ç¡®å®šçœŸå®é•¿åº¦/ç›´å¾„ã€‚
2. **æ”¾ç½®ä½ç½®ï¼ˆæ–‡å­—ä½ç½®ç‚¹ï¼‰**
   - å†³å®šæ ‡æ³¨çº¿å’Œæ–‡å­—æ˜¾ç¤ºåœ¨å›¾ä¸Šçš„å“ªå„¿ã€‚
   - ä½ å¯ä»¥ç”¨ `TransientGeometry.CreatePoint2d()` è‡ªå·±ç”Ÿæˆä¸€ä¸ªç‚¹æ¥æŒ‡å®šä½ç½®ï¼ˆå³ä½¿å®ƒå’Œé»˜è®¤ä½ç½®ä¸ä¸€æ ·ï¼‰ã€‚





### 3 ä½¿ç”¨ä»£ç†

**åŸç”Ÿå¯¹è±¡**ï¼šå·¥å‚é‡Œçš„é›¶ä»¶å›¾çº¸ï¼ˆæ°¸è¿œåœ¨é›¶ä»¶çš„åŸç‚¹åæ ‡ç³»ï¼‰ã€‚

**ä»£ç†å¯¹è±¡**ï¼šé›¶ä»¶è¢«è£…åˆ°æŸä¸ªäº§å“ä¸Šçš„é‚£ä¸€å—ï¼ˆå¸¦ç€å®‰è£…ä½ç½®ã€æ—‹è½¬è§’åº¦çš„ä¿¡æ¯ï¼‰ã€‚

Inventor è£…é…é‡Œä½ é€‰åˆ°çš„å‡ ä½•ï¼Œå‡ ä¹éƒ½æ˜¯â€œä»£ç†â€ï¼Œå®ƒå¸®ä½ åœ¨è£…é…ä¸Šä¸‹æ–‡ä¸­å¼•ç”¨é›¶ä»¶çš„åŸç”Ÿå¯¹è±¡ï¼Œå¹¶è‡ªåŠ¨å¤„ç†åæ ‡å˜æ¢å’Œå®ä¾‹ä¿¡æ¯ã€‚

**åŸç”Ÿå¯¹è±¡çš„åæ ‡æ˜¯é›¶ä»¶è‡ªå·±çš„åæ ‡ï¼Œä»£ç†å¯¹è±¡çš„åæ ‡æ˜¯è€ƒè™‘äº†é›¶ä»¶åœ¨è£…é…ä¸­çš„ä½ç½®å’Œå§¿æ€çš„åæ ‡**ã€‚
 åœ¨è£…é…ç¯å¢ƒé‡Œï¼Œæƒ³å¾—åˆ°æ­£ç¡®ä½ç½® â†’ ç”¨ä»£ç†ï¼›æƒ³å¾—åˆ°å®šä¹‰æœ¬ä½“ â†’ ç”¨åŸç”Ÿå¯¹è±¡ã€‚





**è£…é… =** ä¸€ä¸ªæˆ–å¤šä¸ªé›¶ä»¶ï¼ˆæˆ–å­è£…é…ï¼‰åœ¨åŒä¸€ç©ºé—´ç»„åˆæˆæ•´ä½“çš„æ–‡ä»¶ï¼ŒInventor ç”¨ `.iam` ä¿å­˜ï¼Œå®ƒè®°å½•çš„æ˜¯**é›¶ä»¶çš„å¼•ç”¨å’Œä½ç½®å…³ç³»**ï¼Œè€Œä¸ç›´æ¥å­˜å‡ ä½•ã€‚



### 4 æ–‡ä»¶fileå’Œæ–‡æ¡£document

**æ–‡ä»¶ï¼ˆFileï¼‰** å’Œ **æ–‡æ¡£ï¼ˆDocumentï¼‰** è¿™ä¸¤ä¸ª API æ¦‚å¿µï¼Œå¹¶ä¸”ä»‹ç»äº†å®ƒä»¬ä¹‹é—´çš„**å¼•ç”¨å…³ç³»ï¼ˆDescriptorï¼‰**ã€‚

- **File å¯¹è±¡**
  - å¯¹åº”ç£ç›˜ä¸Šçš„å®é™…æ–‡ä»¶ï¼ˆæ¯”å¦‚ä¸€ä¸ª `.ipt`ã€`.iam`ã€`.idw`ï¼‰ã€‚
  - å­˜åœ¨äºæ–‡ä»¶ç³»ç»Ÿé‡Œã€‚
  - å°±åƒ Word é‡Œçš„ `.docx` æ–‡ä»¶ã€‚
- **Document å¯¹è±¡**
  - å¯¹åº” Inventor å†…å­˜ä¸­æ‰“å¼€çš„é‚£ä¸ªæ¨¡å‹æˆ–å›¾çº¸çš„å®ä¾‹ã€‚
  - ä½ æ‰“å¼€æ–‡ä»¶åï¼Œå®ƒæ‰å˜æˆä¸€ä¸ª Documentã€‚
  - å°±åƒ Word æ‰“å¼€ `.docx` åï¼Œå†…å­˜é‡Œçš„ç¼–è¾‘çª—å£å°±æ˜¯ä¸€ä¸ª Documentã€‚

ğŸ“Œ **é‡ç‚¹**

- ä¸€ä¸ª Document **åªå¯¹åº”ä¸€ä¸ª File**ï¼ˆå®ƒçš„æ¥æºæ–‡ä»¶ï¼‰ã€‚
- ä½†æ˜¯**ä¸€ä¸ª File å¯èƒ½å¯¹åº”å¤šä¸ª Document**ï¼š
- ä¾‹å¦‚å¤šå¼€ä¸€ä¸ªé›¶ä»¶çš„ä¸åŒæ¨¡å‹çŠ¶æ€ï¼ˆä¸åŒæ˜¾ç¤ºé…ç½®ï¼‰æ—¶ï¼Œå®ƒä»¬æ˜¯å†…å­˜é‡Œçš„ä¸åŒ Documentï¼Œä½†ç£ç›˜ä¸Šå…±äº«åŒä¸€ä¸ªæºæ–‡ä»¶ã€‚



### 5 ææ–™å’Œå¤–è§‚

**æè´¨ï¼ˆMaterialï¼‰** å’Œ **å¤–è§‚ï¼ˆé¢œè‰²ã€çº¹ç†ï¼ŒRenderStyleï¼‰** çš„ç®¡ç†æ–¹å¼å˜äº†ï¼Œæ–°çš„ API å¯ä»¥è·¨ä¸åŒ Autodesk è½¯ä»¶å…±äº«å¤–è§‚æ•ˆæœã€‚

å¦‚æœéœ€è¦æ ‡æ³¨â€œæè´¨â€æ–‡å­—ï¼Œåªå­¦ä¼š **è¯»å–å½“å‰æ–‡æ¡£æè´¨åç§°** å°±å¤Ÿäº†ï¼Œä¸ç”¨ç®¡è¿™ä¸ª Consistent Materials çš„ç»†èŠ‚





## äºŒã€é›¶ä»¶å’Œè£…é…ä½“å»ºæ¨¡

### 1 æ¨¡å‹çŠ¶æ€

**LODï¼ˆæ—§çš„ï¼‰**

- API ç±»å‹ï¼š`LevelOfDetailRepresentation`
- å­˜åœ¨äºè£…é…æ–‡ä»¶ï¼ˆAssemblyDocumentï¼‰çš„ `ComponentDefinition.LevelOfDetailRepresentations` é›†åˆé‡Œ
- ä½œç”¨ï¼šè®°å½•â€œå“ªäº›é›¶ä»¶è¢«æŠ‘åˆ¶ã€å“ªäº›é›¶ä»¶è¢«ä¿ç•™â€çš„çŠ¶æ€
- Inventor 2022 ä¹‹åï¼Œè¿™ä¸ªç±»è™½ç„¶è¿˜åœ¨ï¼Œä½†è¢«éšè—ï¼Œä¸å†æ¨èä½¿ç”¨

**Model Stateï¼ˆæ–°çš„ï¼‰**

- API ç±»å‹ï¼š`ModelState`
- å­˜åœ¨äºé›¶ä»¶ï¼ˆPartDocumentï¼‰å’Œè£…é…ï¼ˆAssemblyDocumentï¼‰çš„ `ComponentDefinition.ModelStates` é›†åˆé‡Œ
- ä½œç”¨ï¼šä¿å­˜å®Œæ•´çš„æ¨¡å‹ç‰ˆæœ¬æ•°æ®ï¼ŒåŒ…æ‹¬ï¼š
  - æŠ‘åˆ¶/ä¿ç•™é›¶ä»¶ï¼ˆç­‰åŒæ—§ LOD åŠŸèƒ½ï¼‰
  - å°ºå¯¸ã€ç‰¹å¾å‚æ•°çš„å˜åŒ–
  - iPropertiesï¼ˆå±æ€§ï¼‰çš„å˜åŒ–
  - å¤–è§‚/æè´¨çš„å˜åŒ–

![image-20250814154309209](C:/Users/14088/AppData/Roaming/Typora/typora-user-images/image-20250814154309209.png)



ä»¥è¿™é‡Œä¸ºä¾‹ï¼Œè¿™ä¸ªé›¶ä»¶1çš„æ¨¡å‹çŠ¶æ€(ä¸»è¦)å°±æ˜¯ä¸€ä¸ªmodelStateï¼Œè¿˜å¯ä»¥æœ‰å¤šä¸ªmodelstate è¿›è¡Œä¸åŒçš„æ ‡æ³¨å’Œå±•ç¤º





åœ¨çŸ¥é“äº†model stateæ˜¯ä»€ä¹ˆä¹‹åï¼š

**Inventor 2022 æŠŠ LOD æ›¿æ¢æˆ Model State åï¼Œæ–‡æ¡£æŒ‡é’ˆã€äº‹ä»¶ã€å¼•ç”¨é›†åˆç­‰è¡Œä¸ºå˜äº†ï¼Œå¹¶ä¸”å¢åŠ äº†ä¸€æ•´å¥—æ–°çš„ APIï¼Œè®©ä½ å¯ä»¥åˆ›å»ºã€åˆ‡æ¢ã€ç¼–è¾‘ã€å¼•ç”¨ã€ä¿å­˜ä¸åŒçš„ Model Stateï¼Œç”šè‡³åœ¨å·¥ç¨‹å›¾å’Œ BOM é‡Œåˆ†åˆ«å¤„ç†å®ƒä»¬**



ç”¨ä»£ç å¯ä»¥æ“ä½œmodel state



### 2 è‰å›¾

#### ï¼ˆ1ï¼‰è‰å›¾æ¦‚å¿µ

åœ¨ Inventor é‡Œï¼Œ**è‰å›¾**å°±æ˜¯ä¸€ä¸ª**äºŒç»´ç»˜å›¾å¹³é¢**ï¼Œç”¨æ¥ç”» 2D å‡ ä½•å›¾å½¢ï¼ˆç›´çº¿ã€åœ†ã€å¼§ã€æ ·æ¡ç­‰ï¼‰ã€‚

å¯ä»¥è¿™æ ·ç†è§£ï¼š

- è‰å›¾ = ä¸€å—æ‚¬æµ®åœ¨ä¸‰ç»´ç©ºé—´é‡Œçš„â€œç”»æ¿â€
- ä½ åœ¨ç”»æ¿ä¸Šç”»çš„å›¾å½¢ï¼ˆSketch Entityï¼‰æ˜¯**çº¯äºŒç»´**çš„ï¼ˆåªæœ‰ Xã€Y åæ ‡ï¼‰
- è¿™å—ç”»æ¿æœ¬èº«åœ¨ 3D ç©ºé—´ä¸­æœ‰ä½ç½®å’Œæ–¹å‘ï¼ˆæ¯”å¦‚è´´åœ¨ä¸€ä¸ªå¹³é¢ä¸Šï¼‰

**æ³¨æ„**ï¼šè‰å›¾æœ¬èº«åªæ˜¯ä¸€ä¸ªå®¹å™¨å’Œåæ ‡ç³»ï¼Œä¸å»å…³å¿ƒä½ çš„å›¾å½¢æœ‰æ²¡æœ‰é—­åˆã€æ˜¯å¦èƒ½ç”Ÿæˆç‰¹å¾ã€‚è¿™äº›é—­åˆæ€§ä¿¡æ¯æ˜¯**è½®å»“ï¼ˆProfileï¼‰**æ¥å¤„ç†çš„ã€‚

```vb
'=== åœ¨æ´»åŠ¨é›¶ä»¶ä¸­æ–°å»ºè‰å›¾ï¼ˆXY å¹³é¢ï¼‰ =========================================
If Not TypeOf ThisApplication.ActiveDocument Is PartDocument Then
    MessageBox.Show("è¯·å…ˆæ‰“å¼€ä¸€ä¸ªé›¶ä»¶ï¼ˆ.iptï¼‰")
    Return
End If

Dim part As PartDocument = ThisApplication.ActiveDocument
Dim def  As PartComponentDefinition = part.ComponentDefinition
Dim oSketch As PlanarSketch = def.Sketches.Add(def.WorkPlanes.Item(3)) 'XYå¹³é¢

Dim oTransGeom As TransientGeometry = ThisApplication.TransientGeometry

' å®šä¹‰4ä¸ªçº¿æ®µï¼ˆæ•°ç»„0-3ï¼‰
Dim oLines(3) As SketchLine

' çº¿æ®µ1
Dim oCoord1 As Point2d = oTransGeom.CreatePoint2d(0, 0)
Dim oCoord2 As Point2d = oTransGeom.CreatePoint2d(5, 0)
oLines(0) = oSketch.SketchLines.AddByTwoPoints(oCoord1, oCoord2)

' çº¿æ®µ2
oCoord1 = oTransGeom.CreatePoint2d(5, 3)
oLines(1) = oSketch.SketchLines.AddByTwoPoints(oLines(0).EndSketchPoint, oCoord1)

' åœ†å¼§
oCoord1 = oTransGeom.CreatePoint2d(4, 3) ' åœ†å¿ƒ
oCoord2 = oTransGeom.CreatePoint2d(4, 4) ' å¼§ç»ˆç‚¹
Dim oArc As SketchArc = oSketch.SketchArcs.AddByCenterStartEndPoint(oCoord1, oLines(1).EndSketchPoint, oCoord2)

' çº¿æ®µ3
oCoord1 = oTransGeom.CreatePoint2d(0, 4)
oLines(2) = oSketch.SketchLines.AddByTwoPoints(oArc.EndSketchPoint, oCoord1)

' çº¿æ®µ4
oLines(3) = oSketch.SketchLines.AddByTwoPoints(oLines(0).StartSketchPoint, oLines(2).EndSketchPoint)

' å‡ ä½•çº¦æŸ
oSketch.GeometricConstraints.AddHorizontal(oLines(0))  
' çº¿1æ°´å¹³
oSketch.GeometricConstraints.AddPerpendicular(oLines(0), oLines(1))  
' çº¿1ä¸çº¿2å‚ç›´
oSketch.GeometricConstraints.AddTangent(oLines(1), oArc)  
' çº¿2ä¸åœ†å¼§ç›¸åˆ‡
oSketch.GeometricConstraints.AddTangent(oLines(2), oArc)  
' çº¿3ä¸åœ†å¼§ç›¸åˆ‡
oSketch.GeometricConstraints.AddParallel(oLines(0), oLines(2))  
' çº¿1ä¸çº¿3å¹³è¡Œ
oSketch.GeometricConstraints.AddParallel(oLines(3), oLines(1))  
' çº¿4ä¸çº¿2å¹³è¡Œ

```

è¿™é‡Œçš„å‡ ä½•çº¦æŸæ˜¯ä¸ºäº†æ‹–åŠ¨ä¸€ä¸ªç‚¹çš„æ—¶å€™æ•´ä¸ªå½¢çŠ¶éƒ½è·Ÿç€åŠ¨ï¼Œä¸ç„¶çº¿å’Œçº¿ä¹‹é—´éƒ½æ˜¯ç‹¬ç«‹çš„





#### ï¼ˆ2ï¼‰åˆ©ç”¨è‰å›¾åœ¨é›¶ä»¶ä¸­ç”Ÿæˆç‰¹æ®Šå½¢çŠ¶å›¾å½¢

ä¸‹é¢è¿™æ®µä»£ç 

è¿™æ®µä»£ç å°±æ˜¯ç”¨ iLogicï¼ˆå®é™…ä¸Šæ˜¯ Inventor API çš„ VBA è¯­æ³•ï¼‰åœ¨**é›¶ä»¶æ–‡ä»¶**é‡Œå®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

1. **æ–°å»ºè‰å›¾**ï¼ˆåœ¨æŒ‡å®šå·¥ä½œå¹³é¢ä¸Šåˆ›å»ºï¼Œæ¯”å¦‚ WorkPlane(3)ï¼‰ã€‚
2. **åœ¨è‰å›¾é‡Œç”»çŸ©å½¢**ã€‚
3. **ç”Ÿæˆè½®å»“ï¼ˆProfileï¼‰**ã€‚
4. **æ‹‰ä¼¸æˆå®ä½“ï¼ˆExtrudeï¼‰**â€”â€”ç¬¬ä¸€æ¬¡æ˜¯æ­£å‘æ‹‰ä¼¸ï¼Œå½¢æˆä¸€ä¸ªé•¿æ–¹ä½“ã€‚
5. **åœ¨æ‹‰ä¼¸çš„ç«¯é¢ä¸Šåˆ›å»ºæ–°è‰å›¾**ï¼ˆç”¨ `AddWithOrientation` æ§åˆ¶æ–¹å‘ï¼‰ã€‚
6. **å†ç”»çŸ©å½¢**ã€‚
7. **ç”Ÿæˆæ–°è½®å»“å¹¶æ‹‰ä¼¸åˆ‡é™¤**â€”â€”ç¬¬äºŒæ¬¡æ˜¯åå‘æ‹‰ä¼¸å¹¶é€‰æ‹©â€œåˆ‡é™¤â€æ“ä½œï¼ˆCutï¼‰ã€‚



å…·ä½“çº¦æŸç±»å‹å»çœ‹å¯¹åº”çš„apiæ–‡æ¡£å³å¯

```vb
'==== å‰ç½®ï¼šå¿…é¡»åœ¨é›¶ä»¶æ–‡æ¡£é‡Œ ====
If Not TypeOf ThisApplication.ActiveDocument Is PartDocument Then
    MessageBox.Show("è¯·å…ˆåœ¨é›¶ä»¶ï¼ˆ.iptï¼‰ä¸­è¿è¡Œæ­¤è§„åˆ™ã€‚")
    Return
End If

Dim part As PartDocument = ThisApplication.ActiveDocument
Dim def  As PartComponentDefinition = part.ComponentDefinition
Dim tg   As TransientGeometry = ThisApplication.TransientGeometry

'================ 1) åˆ¤æ–­æ˜¯å¦æœ‰â€œæ´»åŠ¨è‰å›¾â€ï¼Œè‹¥æœ‰å°±æ‹¿åˆ°å®ƒ ================
Dim activeSketch As PlanarSketch = Nothing
If TypeOf ThisApplication.ActiveEditObject Is PlanarSketch Then
    activeSketch = ThisApplication.ActiveEditObject
    ' è¿™é‡Œä½ å¯ä»¥å¯¹æ´»åŠ¨è‰å›¾åšäº‹
Else
    ' æ²¡æœ‰æ´»åŠ¨è‰å›¾ä¹Ÿæ²¡å…³ç³»ï¼Œåé¢ä¼šæ–°å»ºè‰å›¾
End If

'================ 2) éå†å¹¶æ‰“å°æ‰€æœ‰è‰å›¾åç§° ===========================
Dim names As New System.Text.StringBuilder()
For Each sk As PlanarSketch In def.Sketches
    names.AppendLine(sk.Name)
Next
If names.Length > 0 Then
    MessageBox.Show("å½“å‰è‰å›¾åˆ—è¡¨ï¼š" & vbCrLf & names.ToString())
End If

'================ 3) æŒ‰åç§°è·å–è‰å›¾ï¼ˆå®‰å…¨å†™æ³•ï¼‰ =======================
Dim sketchByName As PlanarSketch = Nothing
Dim targetName As String = "Sketch2"   ' æˆ–è€…æ”¹æˆâ€œè‰å›¾2â€/ä½ è‡ªå·±çš„åå­—
Try
    sketchByName = def.Sketches.Item(targetName)
Catch
    ' æœªæ‰¾åˆ°å°±æç¤º
    ' MessageBox.Show($"æœªæ‰¾åˆ°åä¸º {targetName} çš„è‰å›¾ã€‚")
End Try

'================ 4) æ–°å»ºè‰å›¾ï¼ˆAddï¼‰ï¼šåœ¨ XY å¹³é¢ç”»çŸ©å½¢å¹¶å®ä½“æ‹‰ä¼¸ =========
Dim sk1 As PlanarSketch = def.Sketches.Add(def.WorkPlanes.Item(3)) 'å¸¸è§æ¨¡æ¿ä¸­ Item(3) æ˜¯ XY
' ç”»ä¸€ä¸ªä¸¤ç‚¹çŸ©å½¢ï¼š (0,0) åˆ° (5,3)
Call sk1.SketchLines.AddAsTwoPointRectangle( _
        tg.CreatePoint2d(0, 0), tg.CreatePoint2d(5, 3))

' å–è½®å»“å¹¶æ‹‰ä¼¸ï¼ˆ2 cmï¼Œæ­£å‘ï¼ŒJoinï¼‰
Dim prof1 As Profile = sk1.Profiles.AddForSolid
Dim ext1 As ExtrudeFeature = def.Features.ExtrudeFeatures.AddByDistanceExtent( _
        prof1, 2, PartFeatureExtentDirectionEnum.kPositiveExtentDirection, _
        PartFeatureOperationEnum.kJoinOperation)

'================ 5) æ–°å»ºè‰å›¾ï¼ˆAddWithOrientationï¼‰ï¼šç«¯é¢å®šå‘å»ºè‰å›¾ =======
' åœ¨ ext1 çš„ä¸€ä¸ªç«¯é¢ä¸Šå»ºè‰å›¾ï¼Œå¹¶ç”¨å·¥ä½œè½´/åŸç‚¹ç‚¹æ§åˆ¶è‰å›¾æ–¹å‘
Dim sk2 As PlanarSketch = def.Sketches.AddWithOrientation( _
        ext1.EndFaces.Item(1), _                 ' è‰å›¾å¹³é¢ï¼šæ‹‰ä¼¸çš„ç«¯é¢
        def.WorkAxes.Item(1), True, True, _      ' å‚è€ƒè½´ + X/Y ç¿»è½¬ï¼ˆæŒ‰éœ€è°ƒ True/Falseï¼‰
        def.WorkPoints.Item(1), False)           ' å‚è€ƒç‚¹ + æ˜¯å¦è´´åˆé¢ï¼ˆè¿™é‡Œ Falseï¼‰

' åœ¨ç¬¬äºŒæ¡è‰å›¾ä¸Šå†ç”»ä¸€ä¸ªçŸ©å½¢ï¼š (1,1) åˆ° (4,2)
Call sk2.SketchLines.AddAsTwoPointRectangle( _
        tg.CreatePoint2d(1, 1), tg.CreatePoint2d(4, 2))

' å–è½®å»“å¹¶â€œåˆ‡é™¤å¼â€æ‹‰ä¼¸ï¼ˆ0.75 cmï¼Œåå‘ï¼‰
Dim prof2 As Profile = sk2.Profiles.AddForSolid
Dim ext2 As ExtrudeFeature = def.Features.ExtrudeFeatures.AddByDistanceExtent( _
        prof2, 0.75, PartFeatureExtentDirectionEnum.kNegativeExtentDirection, _
        PartFeatureOperationEnum.kCutOperation)

```

#### (3)è‰å›¾å’Œè½®å»“

**è‰å›¾**ï¼šåªæ˜¯ 2D å‡ ä½•å›¾å½¢ + çº¦æŸçš„é›†åˆï¼ˆæ¯”å¦‚çº¿ã€åœ†ã€å¼§ç­‰ï¼‰ã€‚

**è½®å»“ (Profile)**ï¼šä»è‰å›¾ä¸­æŒ‘é€‰ä¸€ç»„**å°é—­çš„å‡ ä½•å›¾å½¢**ï¼Œç”¨æ¥å®šä¹‰ç‰¹å¾ï¼ˆä¾‹å¦‚æŒ¤å‡ºã€æ—‹è½¬ï¼‰çš„å½¢çŠ¶ã€‚

- è‰å›¾åªæ˜¯â€œå›¾å½¢å®¹å™¨â€ï¼ŒçœŸæ­£ç”¨æ¥ç”Ÿæˆ 3D å®ä½“çš„æ˜¯è½®å»“ã€‚

##### 1 ä¸ºä»€ä¹ˆè¦æœ‰è½®å»“

- ä¸€ä¸ªè‰å›¾å¯èƒ½æœ‰å¾ˆå¤šå‡ ä½•ï¼Œæ¯”å¦‚ä¸¤ä¸ªåœ†ã€å¤šä¸ªçŸ©å½¢ã€‚
- ä½ åœ¨åˆ›å»ºç‰¹å¾æ—¶ï¼Œéœ€è¦æŒ‡å®š**åˆ°åº•ç”¨å“ªéƒ¨åˆ†å°é—­åŒºåŸŸ**ä½œä¸ºæˆªé¢ï¼Œè¿™ä¸ªé€‰æ‹©å°±æ˜¯è½®å»“ã€‚
- é€šè¿‡æ·»åŠ **è‰å›¾ç‚¹**ã€**é‡åˆçº¦æŸ**ç­‰ï¼Œå¯ä»¥æ§åˆ¶å“ªäº›åŒºåŸŸèƒ½è¢«é€‰æˆä¸€ä¸ªæ•´ä½“çš„è½®å»“ã€‚

------

##### 2 API é‡Œåˆ›å»ºè½®å»“çš„æ–¹æ³•

API æä¾›ä¸¤ç§æ–¹æ³•ï¼š

1. **`AddForSolid`** â†’ åˆ›å»ºç”¨äºå®ä½“ç‰¹å¾çš„**å°é—­**è½®å»“ï¼ˆæ¯”å¦‚æ‹‰ä¼¸æˆå®å¿ƒï¼‰ã€‚
2. **`AddForSurface`** â†’ åˆ›å»ºç”¨äºè¡¨é¢ç‰¹å¾çš„**å¼€æ”¾**è½®å»“ï¼ˆæ¯”å¦‚æ‹‰ä¼¸æˆæ›²é¢ï¼‰ã€‚

ç‰¹ç‚¹ï¼š

- å¦‚æœä¸åŠ å‚æ•°ï¼Œå®ƒä¼šè‡ªåŠ¨æ£€æŸ¥è‰å›¾é‡Œçš„æ‰€æœ‰å‡ ä½•ï¼Œæ‰¾å‡ºç¬¦åˆæ¡ä»¶çš„è½®å»“ã€‚
- ç»ˆç«¯ç”¨æˆ·åœ¨ç•Œé¢æ“ä½œæ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŠ•å½±ä¸€äº›è¾¹ï¼Œè¿™ä¼šå¢åŠ å¤šä½™å‡ ä½•ï¼Œä½†ç¼–ç¨‹æ—¶é€šå¸¸ä¸éœ€è¦è¿™äº›â€œä¸­é—´å‡ ä½•â€ï¼Œåªè¦ç›´æ¥å¾—åˆ°ç›®æ ‡è½®å»“å°±è¡Œã€‚



### 3 è‰å›¾çº¦æŸ

çº¦æŸå°±æ˜¯åœ¨â€œç‚¹ã€çº¿ã€åœ†å¼§â€ä¹‹é—´åŠ è§„åˆ™ï¼ˆå¹³è¡Œã€å‚ç›´ã€åˆ‡çº¿â€¦ï¼‰ï¼ŒAPI æä¾›äº†å¯¹åº”çš„å‡½æ•°æ¥è‡ªåŠ¨åŠ è¿™äº›è§„åˆ™ã€‚

å‰é¢çš„ä»£ç å·²ç»å±•ç¤ºäº†çº¦æŸ  



### 4 	è¾¹ç•Œæ¡ä»¶

BRep API ç”±ä¸€ç»„å®šä¹‰å›ºä½“å†…éƒ¨å’Œå¤–éƒ¨è¾¹ç•Œçš„å¯¹è±¡ç»„æˆã€‚æ­¤å¤–ï¼Œè¿™äº›å¯¹è±¡è¿˜æä¾›æ‹“æ‰‘ä¿¡æ¯ï¼ŒæŒ‡ç¤ºè¿ç»­çš„è¾¹å’Œç›¸é‚»çš„é¢ï¼Œä»¥ä¾¿å¼€å‘è€…å¯ä»¥éå†è¿™äº›è¾¹å’Œé¢ã€‚BRep API è¿˜æä¾›äº†è¯„ä¼°å™¨å¯¹è±¡ï¼Œç”¨äºåœ¨å„è‡ªçš„å‚æ•°ç©ºé—´å†…å¤„ç† BRep æ›²é¢å’Œè¾¹ï¼ˆæ›²çº¿ï¼‰ã€‚BRep å¯¹è±¡æš´éœ²äº†ä¸€ä¸ª Geometry å±æ€§ï¼Œé€šè¿‡å®ƒå¯ä»¥è·å–å¯¹è±¡çš„åº•å±‚å‡ ä½•ä¿¡æ¯ã€‚



ä»¥ä¸‹ä»£ç ï¼Œè‡ªåŠ¨è¯†åˆ«æ¯ä¸ªé¢ å¹¶åŠ ä¸Šå·¥ä½œç‚¹ã€‚

å¦‚æœæ˜¯å¹³é¢ï¼Œåˆ™åˆ›å»ºè‰å›¾

```vb
'===========================================================
' é¢æ ‡è®°ï¼šä¸ºæ¯ä¸ªé¢æ‰“ä¸­å¿ƒç‚¹
' - æ‰€æœ‰é¢ï¼šæ”¾ 3D å·¥ä½œç‚¹ WorkPointï¼ˆFaceWP_#ï¼‰
' - å¹³é¢é¢ï¼šåœ¨è¯¥é¢å»ºè‰å›¾ï¼Œæ”¾è‰å›¾ç‚¹ + å°åœ†åœˆï¼ˆFaceTag_#ï¼‰
' ä»…æ”¯æŒï¼šé›¶ä»¶(.ipt)
'===========================================================

If Not TypeOf ThisApplication.ActiveDocument Is PartDocument Then
    MessageBox.Show("è¯·åœ¨é›¶ä»¶(.ipt)æ–‡ä»¶ä¸­è¿è¡Œæ­¤è§„åˆ™ã€‚")
    Return
End If

Dim part As PartDocument = ThisApplication.ActiveDocument
Dim def  As PartComponentDefinition = part.ComponentDefinition
Dim tg   As TransientGeometry = ThisApplication.TransientGeometry

' === å¯è°ƒå‚æ•°ï¼ˆå†…éƒ¨å•ä½é€šå¸¸ä¸ºå˜ç±³ cmï¼‰===
Dim circleR As Double = 0.2     ' è‰å›¾å°åœ†åŠå¾„ï¼ˆ0.2cm â‰ˆ 2mmï¼‰

' æ˜¯å¦å…ˆæ¸…ç†ä¸Šæ¬¡ç”Ÿæˆçš„æ ‡è®°ï¼ˆæŒ‰å‘½åå‰ç¼€ï¼‰
Dim cleanup As Boolean = False
If cleanup Then
    ' åˆ å·¥ä½œç‚¹
    For i = def.WorkPoints.Count To 1 Step -1
        Dim wp = def.WorkPoints.Item(i)
        If wp.Name.StartsWith("FaceWP_") Then wp.Delete()
    Next
    ' åˆ æ ‡è®°è‰å›¾
    For i = def.Sketches.Count To 1 Step -1
        Dim skDel = def.Sketches.Item(i)
        If skDel.Name.StartsWith("FaceTag_") Then skDel.Delete()
    Next
End If

Dim faceIdx As Integer = 0
Dim wpCount As Integer = 0
Dim tagCount As Integer = 0

For Each body As SurfaceBody In def.SurfaceBodies
    For Each f As Face In body.Faces
        faceIdx += 1

        ' 1) ç”¨ SurfaceEvaluator å–è¯¥é¢çš„å‚æ•°èŒƒå›´ä¸­å¿ƒ (u,v)
        Dim eval As SurfaceEvaluator = f.Evaluator
        Dim rng As Box2d = eval.ParamRangeRect

        Dim uv(1) As Double
        uv(0) = (rng.MinPoint.X + rng.MaxPoint.X) / 2.0
        uv(1) = (rng.MinPoint.Y + rng.MaxPoint.Y) / 2.0

        ' 2) å°† (u,v) è½¬ä¸º 3D æ¨¡å‹ç‚¹ (x,y,z)
        Dim xyz(2) As Double
        eval.GetPointAtParam(uv, xyz)
        Dim ptModel As Point = tg.CreatePoint(xyz(0), xyz(1), xyz(2))

        ' 3) â€”â€” æ‰€æœ‰é¢ï¼šæ”¾ 3D å·¥ä½œç‚¹ï¼ˆæœ€ç›´è§‚ï¼‰â€”â€”
        Dim wp As WorkPoint = def.WorkPoints.AddFixed(ptModel)
        wp.Name = "FaceWP_" & faceIdx
        wp.Visible = True
        wpCount += 1

        ' 4) â€”â€” ä»…å¹³é¢é¢ï¼šå»ºè‰å›¾ + ç‚¹ + åœ†åœˆ â€”â€” 
        If f.SurfaceType = SurfaceTypeEnum.kPlaneSurface Then
            Dim sk As PlanarSketch = def.Sketches.Add(f)
            sk.Name = "FaceTag_" & faceIdx

            ' æ¨¡å‹ç‚¹ -> è‰å›¾ 2D ç‚¹
            Dim p2 As Point2d = sk.ModelToSketchSpace(ptModel)

            ' 4.1 è‰å›¾ç‚¹ï¼ˆä¸­å¿ƒï¼‰
            sk.SketchPoints.Add(p2)

            ' 4.2 å°åœ†åœˆï¼ˆæ›´æ˜¾çœ¼ï¼‰
            sk.SketchCircles.AddByCenterRadius(p2, circleR)

            sk.Visible = True
            tagCount += 1
        End If
    Next
Next

MessageBox.Show("å®Œæˆï¼šå·¥ä½œç‚¹ " & wpCount & " ä¸ªï¼›å¹³é¢æ ‡è®° " & tagCount & " ä¸ªã€‚")

```

å·¥ä½œç‚¹ â†’ ç»™æ¯ä¸ªé¢ä¸€ä¸ªç©ºé—´ä¸­çš„ä¸­å¿ƒç‚¹ï¼Œæ–¹ä¾¿ä½ ä»¥åå¼•ç”¨ï¼ˆæ¯”å¦‚åšå­”ã€åšè£…é…å®šä½ï¼‰ã€‚

è‰å›¾ â†’ ç»™å¹³é¢é¢ä¸€ä¸ªâ€œè§†è§‰æ ‡è®°â€ï¼Œä½ èƒ½åœ¨ä¸Šé¢ç»§ç»­ç”»ä¸œè¥¿ã€‚



BRep çš„ä»·å€¼åœ¨äºï¼š

- æä¾›äº†**å‡ ä½•åˆ†æ**çš„å…¥å£ï¼ˆæµ‹é‡ç‚¹ã€æ›²ç‡ã€é¢ç§¯ç­‰ï¼‰ã€‚
- æä¾›äº†**æ‹“æ‰‘éå†**çš„èƒ½åŠ›ï¼ˆé¢-è¾¹-é¡¶ç‚¹å…³ç³»ï¼‰ã€‚
- æä¾›äº†**æŒä¹…å¼•ç”¨æœºåˆ¶**ï¼ˆReferenceKeyï¼‰ï¼Œä¿è¯ä½ èƒ½åœ¨æ¨¡å‹æ›´æ–°åä¾æ—§é”å®šåŒä¸€ä¸ªå‡ ä½•å®ä½“ã€‚
- å®ƒæ˜¯ **æ¨¡å‹ç‰¹å¾çš„ç»“æœæè¿°**ï¼Œä¸æ˜¯ç¼–è¾‘æ‰‹æ®µã€‚



 BRep åœ¨ Inventor API ä¸­æœ€å¤§çš„ä»·å€¼æ˜¯ â€”â€” ç»™ä½ ä¸€ä¸ªç¨³å®šã€ç»†ç²’åº¦çš„å‡ ä½•å’Œæ‹“æ‰‘è®¿é—®å…¥å£ï¼Œè®©ä½ èƒ½â€œè¯»æ‡‚æ¨¡å‹â€ï¼Œå¹¶ä¸”é€šè¿‡ ReferenceKey è·¨æ¨¡å‹æ›´æ–°ä¿æŒå¼•ç”¨ä¸ä¸¢å¤±ã€‚







### 5 ç‰¹å¾

1. **çº¦æŸ (Constraint) â€”â€” ç®¡ç‚¹ã€çº¿ã€é¢**

- åœ¨è‰å›¾é‡Œï¼Œä½ ç”»çš„æ˜¯ **å‡ ä½•å…ƒç´ **ï¼šç‚¹ã€çº¿ã€åœ†ã€çŸ©å½¢ç­‰ã€‚
- å¦‚æœä¸åŠ çº¦æŸï¼Œå®ƒä»¬å¯ä»¥éšä¾¿æ‹–åŠ¨ï¼Œå½¢çŠ¶å’Œä½ç½®éƒ½ä¸ç¡®å®šã€‚
- é€šè¿‡çº¦æŸï¼ŒæŠŠè¿™äº›å‡ ä½• **å›ºå®šä½ã€å…³ç³»åŒ–**ï¼š
  - **å‡ ä½•çº¦æŸ**ï¼šå¹³è¡Œã€å‚ç›´ã€ç›¸åˆ‡ã€å¯¹ç§°â€¦â€¦
  - **å°ºå¯¸çº¦æŸ**ï¼šç›´å¾„ã€é•¿åº¦ã€è§’åº¦â€¦â€¦
     ğŸ‘‰ æœ€ç»ˆå¾—åˆ°ä¸€ä¸ª **å®Œå…¨çº¦æŸçš„è‰å›¾**ï¼Œåƒæ˜¯äºŒç»´è“å›¾ã€‚

------

2. **ç‰¹å¾ (Feature) â€”â€” æŠŠå‡ ä½•å˜æˆä¸‰ç»´**

- çº¦æŸåªæ˜¯ä¿è¯è‰å›¾æ­£ç¡®ï¼Œè¿˜åªæ˜¯â€œäºŒç»´â€ã€‚
- ç”¨ç‰¹å¾æ“ä½œï¼ˆæ‹‰ä¼¸ã€æ—‹è½¬ã€æ‰«æã€æ”¾æ ·â€¦â€¦ï¼‰ï¼Œæ‰èƒ½æŠŠè‰å›¾ **ç”Ÿæˆä¸‰ç»´å½¢ä½“**ï¼š
  - æ‹‰ä¼¸ (Extrude)ï¼šæŠŠå°é—­è‰å›¾â€œæ‹‰é«˜â€æˆä¸‰ç»´ã€‚
  - æ—‹è½¬ (Revolve)ï¼šæŠŠå‰–é¢æ—‹è½¬ç”Ÿæˆå®ä½“ã€‚
  - åˆ‡é™¤ (Cut)ï¼šæŠŠå·²æœ‰å®ä½“æŒ–æ‰ä¸€éƒ¨åˆ†ã€‚
  - å€’è§’/åœ†è§’ (Chamfer/Fillet)ï¼šä¿®æ”¹è¾¹ç¼˜å½¢æ€ã€‚

ğŸ‘‰ ç‰¹å¾ = æŠŠè‰å›¾/å‡ ä½• **å˜æˆå®é™…çš„ä¸‰ç»´æ¨¡å‹** æˆ– **ä¿®æ”¹æ¨¡å‹**ã€‚

------

3. **å¯¹åº”å…³ç³»ï¼ˆç®€å•ä¾‹å­ï¼‰**

- è‰å›¾ï¼šä¸€ä¸ªåœ†
  - çº¦æŸï¼šåœ†å¿ƒåœ¨åŸç‚¹ï¼Œç›´å¾„ = 100 mm
- ç‰¹å¾ï¼šæ‹‰ä¼¸ 10 mm
  - ç»“æœï¼šä¸€ä¸ª Ã˜100 Ã— 10 mm çš„åœ†æŸ±ä½“

------

ğŸ”‘ ç®€å•æ€»ç»“ä¸€å¥è¯

- **çº¦æŸ**ï¼šå®šä¹‰å‡ ä½•è§„åˆ™ï¼ˆç‚¹çº¿é¢ä¹‹é—´æ€ä¹ˆæ‘†ã€æ€ä¹ˆå…³è”ï¼‰ã€‚
- **ç‰¹å¾**ï¼šæŠŠå‡ ä½•â€œåŠ å·¥æˆä¸‰ç»´â€ï¼Œæˆ–ä¿®æ”¹ä¸‰ç»´å½¢ä½“ã€‚



### 6 å·¥ä½œç‰¹å¾ï¼ˆè‡ªå»ºçš„åæ ‡ç³»ï¼Œé¢ï¼‰

å·¥ä½œç‰¹å¾ (Work Features) çš„æœ¬è´¨

- åŒ…æ‹¬ **å·¥ä½œç‚¹ (WorkPoint)ã€å·¥ä½œè½´ (WorkAxis)ã€å·¥ä½œå¹³é¢ (WorkPlane)** ä¸‰ç±»ã€‚
- å®ƒä»¬æ˜¯ **æŠ½è±¡çš„å‚è€ƒå‡ ä½•ä½“**ï¼Œä¸ä¼šç›´æ¥æ”¹å˜é›¶ä»¶å½¢çŠ¶ï¼Œä½†ç”¨æ¥ **å®šä½/æ¨å¯¼/æ‰¿è½½åç»­ç‰¹å¾**ã€‚
- å¯ä»¥ç†è§£ä¸º **ä½ åœ¨å»ºæ¨¡æ—¶è‡ªå·±åˆ›é€ çš„â€œå°å‹åæ ‡åŸºå‡†â€**ã€‚

![2-1](APRpicture/2-1.PNG)

ä¾‹å­ï¼šæˆ‘ä¸ºäº†åœ¨ä¸€ä¸ªåœ†æŸ±ä¸Šå¼€æ–œç€çš„å­”æ´ï¼Œå°±éœ€è¦è¿™æ ·çš„å‚è€ƒç³»



### 7 Assembling Parts  è£…é… + BOMé…æ–™æ¸…å•

#### ğŸ”¹è£…é…

ç®€å•ç†è§£å°±æ˜¯æŠŠä¸¤ä¸ªåœ†æŸ±ä½“é›¶ä»¶è£…é…åˆ°ä¸€èµ· æ–¹å¼éšæ„

è¿™é‡Œä¸æ¶‰åŠå…·ä½“é›¶ä»¶æ“ä½œ  å…ˆäº†è§£æ¦‚å¿µå³å¯

#### ğŸ”¹BOM



**BOM (Bill of Materialsï¼Œææ–™æ˜ç»†è¡¨/é›¶ä»¶è¡¨)** å°±æ˜¯ç”¨æ¥ **ç»Ÿè®¡è£…é…ä½“é‡Œçš„æ‰€æœ‰é›¶ä»¶ä¿¡æ¯** çš„æ¸…å•ã€‚

------

#### ğŸ”¹ å®ƒåŒ…å«ä»€ä¹ˆï¼Ÿ

é€šå¸¸åŒ…æ‹¬ï¼š

- åºå· (Item No.)
- é›¶ä»¶åç§° (Part Name)
- é›¶ä»¶ç¼–å· (Part Number)
- æ•°é‡ (Quantity)
- ææ–™ (Material)
- å¤‡æ³¨ (Remark)

------

#### ğŸ”¹ ç®€å•ä¾‹å­

å‡è®¾ä½ æœ‰ä¸€ä¸ªâ€œè½´æ‰¿åº§ç»„ä»¶â€ï¼Œé‡Œé¢æœ‰ï¼šä¸€ä¸ªè½´æ‰¿åº§ã€ä¸¤ä¸ªè½´æ‰¿ã€ä¸€æ ¹è½´ã€å››ä¸ªèºæ “ã€‚
 å¯¹åº”çš„ BOM è¡¨å¯èƒ½æ˜¯è¿™æ ·ï¼š

| åºå· | é›¶ä»¶ç¼–å· | åç§°       | æ•°é‡ | ææ–™     |
| ---- | -------- | ---------- | ---- | -------- |
| 1    | P001     | è½´æ‰¿åº§     | 1    | é“¸é“     |
| 2    | P002     | è½´æ‰¿       | 2    | GCr15    |
| 3    | P003     | è½´         | 1    | 45é’¢     |
| 4    | P004     | å…­è§’èºæ “M8 | 4    | é’¢ï¼Œé•€é”Œ |





## ä¸‰ï¼Œç»˜å›¾

### 1 ç»˜å›¾è§†å›¾Drawing Views

API èƒ½åšçš„äº‹

- ä½ å¯ä»¥ç”¨ **ä»£ç ** åœ¨å›¾çº¸ä¸Šè‡ªåŠ¨ï¼š
  1. **æ–°å»ºå›¾çº¸**ï¼ˆSheetï¼‰ï¼›
  2. **æ”¾ç½®åŸºè§†å›¾ (Base View)**ï¼Œæ¯”å¦‚æ­£è§†å›¾ï¼›
  3. ä»åŸºè§†å›¾ **æ´¾ç”ŸæŠ•å½±è§†å›¾ (Projected View)**ï¼Œæ¯”å¦‚ä¾§è§†å›¾ã€ä¿¯è§†å›¾ï¼›
  4. å†æ´¾ç”Ÿ **å‰–è§†å›¾ã€å±€éƒ¨è§†å›¾**ç­‰ã€‚
- ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸éœ€è¦äººå·¥æ‹–æ”¾ â†’ **ä»£ç å°±èƒ½ä¸€é”®ç”Ÿæˆâ€œæ­£è§†+ä¾§è§†+ä¿¯è§†+å‰–è§†â€å¸ƒå±€**



è¿™é‡Œçš„ç”Ÿæˆå›¾çº¸ï¼Œè²Œä¼¼å°±æ˜¯ç”Ÿæˆä¸€ä¸ªç”¨äºæ ‡æ³¨çš„èƒŒæ™¯

ä½†æ˜¯æ„ä¹‰ä¸å¤§ å› ä¸ºç¼ºå°‘åˆ›å»ºå›¾çº¸åä¸‹æ–¹çš„è¡¨æ ¼ç­‰ä¿¡æ¯ æ‰€ä»¥**æ— éœ€åˆ›å»ºåŠŸèƒ½**



![2-2](APRpicture/2-2.PNG)









```
'=== iLogicï¼šæ ¹æ®é€‰æ‹©çš„æ›²çº¿ç±»å‹è‡ªåŠ¨åŠ å°ºå¯¸ï¼ˆç›´çº¿â†’çº¿æ€§ï¼›æ•´åœ†â†’ç›´å¾„ï¼›åœ†å¼§â†’åŠå¾„ï¼‰ ===
Dim drw As DrawingDocument = TryCast(ThisApplication.ActiveDocument, DrawingDocument)
If drw Is Nothing Then
    MessageBox.Show("è¯·åœ¨å·¥ç¨‹å›¾(.idw/.dwg)ä¸­è¿è¡Œæœ¬è§„åˆ™ã€‚", "iLogic") : Return
End If

Dim sheet As Sheet = drw.ActiveSheet
Dim cm As CommandManager = ThisApplication.CommandManager
Dim tg As TransientGeometry = ThisApplication.TransientGeometry

' è®©ä½ ç‚¹ä¸€æ¡è¾¹ï¼ˆæ›²çº¿æ®µï¼‰
Dim pickObj As Object = cm.Pick(SelectionFilterEnum.kDrawingCurveSegmentFilter, _
                                "è¯·é€‰æ‹©ä¸€æ¡è¾¹ï¼ˆç›´çº¿/æ•´åœ†/åœ†å¼§ï¼›å°½é‡åœ¨æ­£æŠ•å½±è§†å›¾é‡Œç‚¹ï¼‰")
If pickObj Is Nothing Then Return

Dim seg As DrawingCurveSegment = TryCast(pickObj, DrawingCurveSegment)
If seg Is Nothing Then
    MessageBox.Show("é€‰æ‹©çš„ä¸æ˜¯å·¥ç¨‹å›¾ä¸­çš„æ›²çº¿æ®µã€‚", "iLogic") : Return
End If

Dim dc As DrawingCurve = seg.Parent
If dc Is Nothing Then
    MessageBox.Show("æœªæ‰¾åˆ°æ›²çº¿çš„çˆ¶å¯¹è±¡ã€‚", "iLogic") : Return
End If

Try
    Select Case dc.CurveType

        Case Curve2dTypeEnum.kLineSegmentCurve2d
            ' â€”â€” ç›´çº¿ï¼šç”¨ AddLinearï¼ˆç”¨è¯¥çº¿çš„èµ·ç‚¹/ç»ˆç‚¹ä½œä¸ºä¸¤ä¸ªå‚è€ƒï¼‰
            Dim gi1 As GeometryIntent = sheet.CreateGeometryIntent(seg, PointIntentEnum.kStartPointIntent)
            Dim gi2 As GeometryIntent = sheet.CreateGeometryIntent(seg, PointIntentEnum.kEndPointIntent)

            ' åœ¨ä¸­ç‚¹æ³•å‘åç§» 2 cm è½å°ºå¯¸ï¼ˆå·¥ç¨‹å›¾åæ ‡å•ä½=å˜ç±³ï¼‰
            Dim p1 As Point2d = seg.StartPoint, p2 As Point2d = seg.EndPoint
            Dim mx As Double = (p1.X + p2.X) / 2.0, my As Double = (p1.Y + p2.Y) / 2.0
            Dim dx As Double = p2.X - p1.X, dy As Double = p2.Y - p1.Y
            Dim L As Double = Math.Sqrt(dx*dx + dy*dy) : If L = 0 Then Throw New Exception("çº¿æ®µé•¿åº¦ä¸º 0")
            Dim nx As Double = -dy / L, ny As Double = dx / L
            Dim place As Point2d = tg.CreatePoint2d(mx + nx*2.0, my + ny*2.0)

            sheet.DrawingDimensions.GeneralDimensions.AddLinear(place, gi1, gi2)
            MessageBox.Show("å·²åˆ›å»ºã€çº¿æ€§å°ºå¯¸ã€‘ã€‚", "iLogic")

        Case Curve2dTypeEnum.kCircleCurve2d
            ' â€”â€” æ•´åœ†ï¼šAddDiameter
            ' å¯¹åœ†ï¼Œå‡ ä½•æ„å›¾ç”¨æ•´æ¡ DrawingCurve æ›´ç¨³å¦¥
            Dim giC As GeometryIntent = sheet.CreateGeometryIntent(dc)
            Dim m As Point2d = seg.MidPoint
            Dim placeD As Point2d = tg.CreatePoint2d(m.X + 2.0, m.Y)
            sheet.DrawingDimensions.GeneralDimensions.AddDiameter(placeD, giC)
            MessageBox.Show("å·²åˆ›å»ºã€ç›´å¾„å°ºå¯¸ã€‘ã€‚", "iLogic")

        Case Curve2dTypeEnum.kCircularArcCurve2d
            ' â€”â€” åœ†å¼§ï¼šAddRadius
            Dim giA As GeometryIntent = sheet.CreateGeometryIntent(dc)
            Dim m As Point2d = seg.MidPoint
            Dim placeR As Point2d = tg.CreatePoint2d(m.X + 0.2, m.Y)
            sheet.DrawingDimensions.GeneralDimensions.AddRadius(placeR, giA)
            MessageBox.Show("å·²åˆ›å»ºã€åŠå¾„å°ºå¯¸ã€‘ã€‚", "iLogic")

        Case Else
            MessageBox.Show("å½“å‰æ›²çº¿ç±»å‹ä¸æ”¯æŒè‡ªåŠ¨æ ‡æ³¨ï¼ˆç±»å‹ï¼š" & dc.CurveType.ToString & "ï¼‰ã€‚", "iLogic")
    End Select

Catch ex As Exception
    MessageBox.Show("åˆ›å»ºå°ºå¯¸å¤±è´¥ï¼š" & ex.Message & vbCrLf & _
                    "æç¤ºï¼šè¯·å°½é‡åœ¨ã€æ­£æŠ•å½±è§†å›¾ã€‘é‡Œé€‰æ‹©ç›´çº¿/åœ†/åœ†å¼§ï¼›" & vbCrLf & _
                    "è‹¥ä¸ºåœ†æŸ±ï¼Œè¯·ç‚¹çŸ©å½¢ä¾§è¾¹ï¼ˆç›´çº¿ï¼‰ï¼Œç«¯é¢åœ†è¯·ç”¨ç›´å¾„/åŠå¾„ã€‚", "iLogic")
End Try

```







è¿™ä¸ªå¯ä»¥ç»™åœ†æŸ±åŠ ç›´å¾„äº† ä½†æ˜¯ç›´çº¿çš„é«˜è¿˜æœ‰é—®é¢˜

```vb
' iLogicï¼šæŒ‰æ‰€é€‰å‡ ä½•è‡ªåŠ¨æ ‡æ³¨ï¼ˆç›´çº¿â†’çº¿æ€§ï¼›æ•´åœ†â†’ç›´å¾„ï¼›åœ†å¼§â†’åŠå¾„ï¼‰

' === åŸºæœ¬æ–‡æ¡£æ£€æŸ¥ ===
Dim doc As Document
doc = ThisApplication.ActiveDocument
If Not TypeOf doc Is DrawingDocument Then
    MessageBox.Show("è¯·åœ¨å·¥ç¨‹å›¾(.idw/.dwg)ä¸­è¿è¡Œæœ¬è§„åˆ™ã€‚", "iLogic")
    Return
End If

' è½¬æ¢æˆ DrawingDocument ç±»å‹
Dim drw As DrawingDocument
drw = CType(doc, DrawingDocument)

' è·å–å½“å‰å›¾çº¸å’Œå·¥å…·å¯¹è±¡
Dim sheet As Sheet
sheet = drw.ActiveSheet

Dim cm As CommandManager
cm = ThisApplication.CommandManager

Dim tg As TransientGeometry
tg = ThisApplication.TransientGeometry

' === ç”¨æˆ·é€‰æ‹©å‡ ä½• ===
' é™åˆ¶åªèƒ½é€‰æ‹©å·¥ç¨‹å›¾ä¸­çš„æ›²çº¿æ®µï¼ˆDrawingCurveSegmentï¼‰
Dim pickObj As Object
pickObj = cm.Pick(SelectionFilterEnum.kDrawingCurveSegmentFilter, "è¯·é€‰æ‹©ä¸€æ¡è¾¹ï¼ˆç›´çº¿/æ•´åœ†/åœ†å¼§ï¼›å°½é‡åœ¨æ­£æŠ•å½±è§†å›¾é‡Œç‚¹ï¼‰")
If pickObj Is Nothing Then Return

' ç¡®è®¤é€‰åˆ°çš„æ˜¯ DrawingCurveSegment
Dim seg As DrawingCurveSegment
If TypeOf pickObj Is DrawingCurveSegment Then
    seg = CType(pickObj, DrawingCurveSegment)
Else
    MessageBox.Show("é€‰æ‹©çš„ä¸æ˜¯å·¥ç¨‹å›¾ä¸­çš„æ›²çº¿æ®µã€‚", "iLogic")
    Return
End If

' è·å–æ›²çº¿å¯¹è±¡ï¼ˆDrawingCurveï¼‰
Dim dc As DrawingCurve
dc = seg.Parent
If dc Is Nothing Then
    MessageBox.Show("æœªæ‰¾åˆ°æ›²çº¿çš„çˆ¶å¯¹è±¡ã€‚", "iLogic")
    Return
End If

' è·å–æ›²çº¿ç±»å‹ï¼ˆå­—ç¬¦ä¸²å½¢å¼ï¼Œä¾‹å¦‚ kLineSegmentCurveã€kCircleCurve ç­‰ï¼‰
Dim curveTypeStr As String
curveTypeStr = dc.CurveType.ToString()

' === ç›´çº¿æƒ…å†µï¼šAddLinear ===
If (curveTypeStr = "kLineSegmentCurve2d") Or (curveTypeStr = "kLineSegmentCurve") Then
    ' åˆ›å»ºå‡ ä½•æ„å›¾ï¼Œåˆ†åˆ«å–ç›´çº¿æ®µçš„èµ·ç‚¹å’Œç»ˆç‚¹
    Dim gi1 As GeometryIntent
    gi1 = sheet.CreateGeometryIntent(seg, PointIntentEnum.kStartPointIntent)
    Dim gi2 As GeometryIntent
    gi2 = sheet.CreateGeometryIntent(seg, PointIntentEnum.kEndPointIntent)

    ' è·å–èµ·ç‚¹å’Œç»ˆç‚¹åæ ‡
    Dim p1 As Point2d, p2 As Point2d
    p1 = seg.StartPoint
    p2 = seg.EndPoint

    ' è®¡ç®—ä¸­ç‚¹åæ ‡
    Dim mx As Double, my As Double
    mx = (p1.X + p2.X) / 2
    my = (p1.Y + p2.Y) / 2

    ' è®¡ç®—çº¿æ®µæ–¹å‘å‘é‡é•¿åº¦
    Dim dx As Double, dy As Double, L As Double
    dx = p2.X - p1.X
    dy = p2.Y - p1.Y
    L = System.Math.Sqrt(dx * dx + dy * dy)
    If L <= 0.0000001 Then
        MessageBox.Show("çº¿æ®µé•¿åº¦ä¸º 0ã€‚", "iLogic")
        Return
    End If

    ' æ±‚æ³•å‘é‡ï¼ˆå‚ç›´æ–¹å‘ï¼‰ï¼Œå¹¶åç§» 2 cm æ”¾ç½®å°ºå¯¸
    Dim nx As Double, ny As Double
    nx = -dy / L
    ny = dx / L

    Dim place As Point2d
    place = tg.CreatePoint2d(mx + nx * 2, my + ny * 2)

    ' åˆ›å»ºçº¿æ€§å°ºå¯¸
    Dim dimObj As LinearGeneralDimension
    dimObj = sheet.DrawingDimensions.GeneralDimensions.AddLinear(place, gi1, gi2)
    MessageBox.Show("å·²åˆ›å»ºã€çº¿æ€§å°ºå¯¸ã€‘ã€‚", "iLogic")
    Return
End If

' === æ•´åœ†æƒ…å†µï¼šAddDiameter ===
If (curveTypeStr = "kCircleCurve2d") Or (curveTypeStr = "kCircleCurve") Then
    ' å¯¹æ•´åœ†ï¼Œå‡ ä½•æ„å›¾ç›´æ¥ç”¨æ•´æ¡ DrawingCurve
    Dim giC As GeometryIntent
    giC = sheet.CreateGeometryIntent(dc)

    ' ä½¿ç”¨åœ†å¿ƒä½œä¸ºåŸºå‡†ç‚¹ï¼ˆä¸æ˜¯ MidPointï¼Œé¿å…å‡ºé”™ï¼‰
    Dim centerPoint As Point2d
    centerPoint = dc.CenterPoint
    
    ' æ”¾ç½®ç‚¹åœ¨åœ†å¿ƒå³å 2 cmï¼Œä¸Šå 10 cm
    Dim placeD As Point2d
    placeD = tg.CreatePoint2d(centerPoint.X + 2, centerPoint.Y + 10)

    ' åˆ›å»ºç›´å¾„å°ºå¯¸
    Dim dia As DiameterGeneralDimension
    dia = sheet.DrawingDimensions.GeneralDimensions.AddDiameter(placeD, giC)
    MessageBox.Show("å·²åˆ›å»ºã€ç›´å¾„å°ºå¯¸ã€‘ã€‚", "iLogic")
    Return
End If

' === åœ†å¼§æƒ…å†µï¼šAddRadius ===
If (curveTypeStr = "kCircularArcCurve2d") Or (curveTypeStr = "kCircularArcCurve") Then
    ' å¯¹åœ†å¼§ï¼Œå‡ ä½•æ„å›¾åŒæ ·ç”¨ DrawingCurve
    Dim giA As GeometryIntent
    giA = sheet.CreateGeometryIntent(dc)

    ' ä½¿ç”¨åœ†å¿ƒä½œä¸ºå‚è€ƒç‚¹
    Dim centerPoint As Point2d
    centerPoint = dc.CenterPoint
    
    ' æ”¾ç½®ç‚¹åœ¨åœ†å¿ƒå³å 20 cm
    Dim placeR As Point2d
    placeR = tg.CreatePoint2d(centerPoint.X + 20, centerPoint.Y)

    ' åˆ›å»ºåŠå¾„å°ºå¯¸
    Dim rad As RadiusGeneralDimension
    rad = sheet.DrawingDimensions.GeneralDimensions.AddRadius(placeR, giA)
    MessageBox.Show("å·²åˆ›å»ºã€åŠå¾„å°ºå¯¸ã€‘ã€‚", "iLogic")
    Return
End If

' === å…¶ä»–ç±»å‹ï¼šä¸æ”¯æŒ ===
MessageBox.Show("å½“å‰æ›²çº¿ç±»å‹æš‚ä¸æ”¯æŒè‡ªåŠ¨æ ‡æ³¨ï¼ˆç±»å‹ï¼š" & curveTypeStr & "ï¼‰ã€‚", "iLogic")

```

```vb
Sub CreateDimension()
        
    Dim oDoc As DrawingDocument
    Set oDoc = ThisApplication.ActiveDocument
    
    Dim oSheet As Sheet
    Set oSheet = oDoc.ActiveSheet
    Dim oCurve1 As DrawingCurve
    Set oCurve1 = oDoc.SelectSet(1).Parent
    
    Dim oCurve2 As DrawingCurve
    Set oCurve2 = oDoc.SelectSet(2).Parent
Dim oIntent1 As GeometryIntent
    Set oIntent1 = oSheet.CreateGeometryIntent(oCurve1)
        
    Dim oIntent2 As GeometryIntent
    Set oIntent2 = oSheet.CreateGeometryIntent(oCurve2)
 Dim oPt As Point2d
    Set oPt = ThisApplication.TransientGeometry.CreatePoint2d(15, 15)
 Dim oLinDim As LinearGeneralDimension
    Set oLinDim = oSheet.DrawingDimensions.GeneralDimensions.AddLinear(oPt, oIntent1, oIntent2)
    
End Sub
```

| å¯¹æ¯”ç‚¹             | ä»£ç 1---agentç”Ÿæˆè°ƒè¯•ç‰ˆ                                      | ä»£ç 2---APiæ–‡æ¡£ç®€å•ç‰ˆ                         |
| ------------------ | ------------------------------------------------------------ | --------------------------------------------- |
| **é€‰æ‹©æ–¹å¼**       | `cm.Pick(SelectionFilterEnum...)`ï¼Œç”¨æˆ·ç‚¹é€‰ï¼Œæœ‰ç±»å‹æ ¡éªŒ      | `oDoc.SelectSet(1/2)`ï¼Œç›´æ¥å–å·²æœ‰é€‰æ‹©ï¼Œæ— æ ¡éªŒ |
| **å‡ ä½•å¯¹è±¡ç²’åº¦**   | `DrawingCurveSegment`ï¼ˆçº¿æ®µç«¯ç‚¹çº§åˆ«ï¼‰ï¼Œå†è½¬ `DrawingCurve`   | `DrawingCurve`ï¼ˆæ•´æ›²çº¿ï¼‰ï¼Œä¸å…³å¿ƒç«¯ç‚¹          |
| **GeometryIntent** | `CreateGeometryIntent(seg, kStartPointIntent/EndPointIntent)`ï¼ˆç²¾ç¡®åˆ°ç«¯ç‚¹ï¼‰ | `CreateGeometryIntent(oCurve)`ï¼ˆæ•´æ›²çº¿ï¼‰      |
| **å°ºå¯¸ç±»å‹ API**   | æ ¹æ®æ›²çº¿ç±»å‹åˆ†æ”¯ï¼š`AddLinear`ï¼ˆç›´çº¿ï¼‰ã€`AddDiameter`ï¼ˆæ•´åœ†ï¼‰ã€`AddRadius`ï¼ˆåœ†å¼§ï¼‰ | åªç”¨ `AddLinear`                              |
| **æ”¾ç½®ç‚¹**         | åŠ¨æ€è®¡ç®—ï¼ˆä¸­ç‚¹+æ³•å‘ã€ä¸­å¿ƒç‚¹åç½®ï¼‰ï¼Œå°½é‡ä¸æŒ¤                  | å›ºå®šåæ ‡ `(15,15)`                            |
| **å¥å£®æ€§**         | æœ‰é”™è¯¯æ£€æŸ¥ã€æç¤ºï¼Œå®¹é”™å¼º                                     | æ²¡æœ‰æ£€æŸ¥ï¼Œä¾èµ–ç”¨æˆ·æ“ä½œï¼Œå®¹æ˜“æŠ¥é”™              |
| **é€‚ç”¨åœºæ™¯**       | æ‰¹é‡ã€è‡ªåŠ¨åŒ–ã€å¥å£®æ€§è¦æ±‚é«˜                                   | ç®€å•ã€å¿«é€Ÿã€ä¸€æ¬¡æ€§è„šæœ¬                        |

ğŸ‘‰ æ€»ç»“ä¸€å¥è¯ï¼š
 **ä»£ç 1** æ˜¯â€œè‡ªåŠ¨åŒ–ã€å¥å£®ã€è¦†ç›–ç›´çº¿/åœ†/å¼§â€çš„å®Œæ•´æ–¹æ¡ˆï¼›
 **ä»£ç 2** æ˜¯â€œå¿«é€Ÿæ‹‰çº¿æ€§å°ºå¯¸â€çš„æœ€ç®€è„šæœ¬ï¼Œåªèƒ½å¤„ç†ç”¨æˆ·é€‰çš„ä¸¤æ¡æ›²çº¿ã€‚